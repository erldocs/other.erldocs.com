<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>xhttpc (xhttpc) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>xhttpc</h1>
<h2 class="modsummary">
   xhttpc main API module.</h2>
<div class="description">
<p>
   xhttpc main API module.
   Example session:
   </p><pre class="sh_erlang">
   % initialize new session with 3 middlewares
   S = xhttpc:init([{cookie_middleware, []},
                    {referer_middleware, []},
                    {compression_middleware, []}]),
  
   % perform request
   {S2, {ok, {{200, "OK"}, ResponseHeaders, ResponseBody}}} =
       xhttpc:request(S, #xhttpc_request{url="http://example.com/"}),
   % the internal states of middlewares (cookies, current referrer etc) + some
   % meta-information are stored in S2, so, if you need to perform one more
   % request, you should pass new session as first parameter.
  
   % perform 2'nd request
   {S3, {ok, {{200, "OK"}, ResponseHeaders, ResponseBody}}} =
       xhttpc:request(S2, #xhttpc_request{url="http://example.com/some/page"}),
  
   % terminate session
   ok = xhttpc:terminate(S3).
   </pre></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-http_header">http_header() = {string(), string()}</h3></div>
    <div class="type"><h3 id="type-http_method">http_method() = get | post | head | string()</h3></div>
    <div class="type"><h3 id="type-http_options">http_options() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{disable_middlewares, [module()]} |<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{timeout, timeout()} |<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{client_options, any()} |<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{atom(), any()}]</h3></div>
    <div class="type"><h3 id="type-http_post_body">http_post_body() = iolist()</h3></div>
    <div class="type"><h3 id="type-http_resp_body">http_resp_body() = binary() | undefined</h3></div>
    <div class="type"><h3 id="type-http_response">http_response() = {ok,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{integer() >= 1, string()},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<a href="#type-http_header" class="seealso">http_header()</a>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#type-http_resp_body" class="seealso">http_resp_body()</a>}}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {error, atom()}</h3></div>
    <div class="type"><h3 id="type-middleware">middleware() = {Module :: module(), Args :: [any()]}</h3></div>
    <div class="type"><h3 id="type-request">request() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#xhttpc_request{url = undefined | string(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method = get | post | head,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headers = [<a href="#type-http_header" class="seealso">http_header()</a>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body = undefined | iolist(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options = <a href="#type-http_options" class="seealso">http_options()</a>}</h3></div>
    <div class="type"><h3 id="type-response">response() = <a href="#type-http_response" class="seealso">http_response()</a></h3></div>
    <div class="type"><h3 id="type-session">session() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#session{mw_args = undefined | [<a href="#type-middleware" class="seealso">middleware()</a>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mw_order = undefined | [atom()],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mw_states = undefined | <a href="orddict.html#type-orddict" class="seealso">orddict:orddict()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http_backend = any()}</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="init/1">init(Middlewares::middleware()) -&gt; session()</h3>


<div class="description">

<p>Initialize middlewares (call each middleware's <code>init/1</code> and collect states)</p>
</div></div>
<div class="function">
<h3 id="init/2">init(Middlewares, HttpBackend) -&gt; term()
</h3>


<div class="description">

<p>Like <a href="#init/1" class="seealso">init/1</a>, but allow to specify http backend (hardcoded for now)</p>
</div></div>
<div class="function">
<h3 id="terminate/1">terminate(Session::session(), Reason::any()) -&gt; ok</h3>


<div class="description">

<p>Terminate session (call each middleware's <code>terminate/2</code>)</p>
</div></div>
<div class="function">
<h3 id="call/1">call(Session::session(), Mod::module(), Args::[any()]) -&gt; {session(), any()}</h3>


<div class="description">

<p>Call middleware (call <code>call/2</code> of middleware <code>Mod</code>)</p>
</div></div>
<div class="function">
<h3 id="request/1">request(S::session(), Url::string(), Method::http_method(), Headers::[http_header()], Body::http_post_body(), Options::http_options()) -&gt; {session(), http_response()}</h3>


<div class="description">

<p>Perform HTTP request (positional argument API)</p>
</div></div>
<div class="function">
<h3 id="request/1-1">request(S::session(), Xhttpc_request::request()) -&gt; {session(), http_response()}</h3>


<div class="description">

<p>Perform HTTP request (record API)</p>
</div></div>
<div class="function">
<h3 id="header_value/1">header_value(Name::string(), Headers::[http_header()]) -&gt; string() | undefined</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="normalize_headers/1">normalize_headers(Headers::[http_header()]) -&gt; [http_header()]</h3>


<div class="description">

<p>Prepare headers for comparision, so "user-agent" and "User-Agent" can be
  compared as equal after normalization</p>
</div></div>
<div class="function">
<h3 id="normalize_header_name/1">normalize_header_name(Name::string()) -&gt; string()</h3>


<div class="description">

<p>Prepare header name for comparision (see <code>normalize_headers</code>)
  If your middleware adds new headers, you SHOULD call this function with
  header name like:
  <code>NewHeaders = [{normalize_header_name("user-agent"), "xhttpc"}] ++ Headers.</code>
  If it's too long to type, just define a macro:
  <code>-define(NH(Name), xhttpc:normalize_header_name(Name)).</code></p>
</div></div></div>

<authors>

<aname>Sergey Prokhorov</aname>
<email>me@seriyps.ru</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
