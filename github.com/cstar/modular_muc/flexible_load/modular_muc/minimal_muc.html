<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>minimal_muc (modular_muc) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>minimal_muc</h1>
<h2 class="modsummary"/>
<div class="description">
</div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="init/3">init(DefRoomOpts, Creator, Nick::string(), Headers) -&gt; {result, ok, Headers} | {error, Why, Headers}</h3>

<ul class="type">
<li><code>DefRoomOpts = [{atom(), any()}]</code></li><li><code>Creator = jid() (see module mod_muc)</code></li><li><code>Headers = headers()</code></li></ul>
<div class="description">

<p>Called upon new room creation.
   DefRoomOpts : are default options as defined in the ejabberd config file.
   Creator : Creator of the room</p>
</div></div>
<div class="function">
<h3 id="init/2">init(Opts, Headers) -&gt; {result, ok, Headers} | {error, Why, Headers}</h3>

<ul class="type">
<li><code>DefRoomOpts = [{atom(), any()}]</code></li><li><code>Headers = headers()</code></li></ul>
<div class="description">

<p>Called upon room reloading (if room is persistent)</p>
</div></div>
<div class="function">
<h3 id="process_private_message/4">process_private_message(From, ToNick, Packet, Headers) -&gt; {allow, Packet2, Headers} | {deny, ErrorMessage, Headers}</h3>

<ul class="type">
<li><code>Packet = string()</code></li><li><code>Packet2 = string()</code></li><li><code>Headers = headers()</code></li></ul>
<div class="description">

<p>Processes private messages from a user to a specific nick.
  It is possible to block message delivery or modify message before delivery</p>
</div></div>
<div class="function">
<h3 id="process_groupchat_message/5">process_groupchat_message(From, Packet, FromNick, Role, Headers) -&gt; {allow, Packet2, Headers} | {deny, ErrorMessage, Headers} | {filter, {Packet2, Fun}, Headers} | {drop, Packet2, Headers}</h3>

<ul class="type">
<li><code>Packet = string()</code></li><li><code>Packet2 = string()</code></li><li><code>ErrorMessage = string()</code></li><li><code>Headers = headers()</code></li><li><code>Fun = fun(FromNick, Role, Info)</code></li><li><code>FromNick = string()</code></li><li><code>Role = atom()</code></li><li><code>Info = term()</code></li></ul>
<div class="description">

<p>filters groupchat message.
  Possible options are :
  </p><list>
   <item><p>allow : message is delivered, and possibly modified</p></item>
   <item><p>deny : message is not delivered, and ErrorMessage is returned as a Forbidden error</p></item>
   <item><p>drop : message is silently dropped</p></item>
   <item><p>filter : Fun is used to decide if message should be delivered per recipient, should return true or false</p></item>
 </list>
</div></div>
<div class="function">
<h3 id="process_user_iq/5">process_user_iq(From, ToNick, Lang, Packet, Headers) -&gt; {allow, Packet2, Headers} | {deny, ErrorMessage, Headers}</h3>

<ul class="type">
<li><code>Packet = string()</code></li><li><code>Packet2 = string()</code></li><li><code>Headers = headers()</code></li><li><code>Lang = string()</code></li></ul>
<div class="description">

<p>Processes iq stanzas from a user to a specific nick.
  It is possible to block iq delivery or modify iq before delivery
  get, set, result and errors are filtered.</p>
</div></div>
<div class="function">
<h3 id="process_iq/7">process_iq(UserInfo, FAffiliation, XMLNS, Type, Lang, SubEl, Headers) -&gt; {result, SubEl2, Headers} | {error, ErrorMessage, Headers}</h3>

<ul class="type">
<li><code>SubEl = string()</code></li><li><code>SubEl2 = string()</code></li><li><code>UserInfo = user()</code></li><li><code>FAffiliation = atom()</code></li><li><code>XMLNS = string()</code></li><li><code>Type = get | set</code></li><li><code>Headers = headers()</code></li><li><code>Lang = string()</code></li></ul>
<div class="description">

<p>Processes iq stanzas from a user to chatroom
  This function is called only if the default mod_muc iq do not correspond. It is not possible to override default iq, such as ?NS_MUC_ADMIN or ?NS_MUC_OWNER
  Chatroom configuration is handled by <a href="minimal_muc.html#get_config/4" class="seealso">minimal_muc:get_config/4 </a> and <a href="minimal_muc.html#set_config/5" class="seealso">minimal_muc:set_config/5</a></p>
</div></div>
<div class="function">
<h3 id="process_presence/1">process_presence(From::jid(), Packet, Nick::string(), Lang::string(), Headers::headers()) -&gt; {allow, Packet2, Headers} | {deny, ErrorMessage, Headers}</h3>

<ul class="type">
<li><code>Packet = string()</code></li><li><code>Packet2 = string()</code></li><li><code>Headers = headers()</code></li></ul>
<div class="description">

<p>Processes presence sent to the room
  It is possible to block presence delivery or modify presence before delivery</p>
</div></div>
<div class="function">
<h3 id="handle_sync_event/3">handle_sync_event(Event, From, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(Info, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="set_config/5">set_config(UserInfo, Aff, XEl, Lang, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_config/4">get_config(UserInfo, Affiliation, Lang, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="process_changed_ra/5">process_changed_ra(TJID, Type, Value, Reason, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="is_persistent/1">is_persistent(Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="is_anonymous/1">is_anonymous(Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="should_log/1">should_log(Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_max_users/1">get_max_users(Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="can_get_affiliations/1">can_get_affiliations(UserInfo::user(), FAffiliation::atom(), Headers::headers()) -&gt; true | false</h3>


<div class="description">

<p>Can the user retrieve the affiliations list ?</p>
</div></div>
<div class="function">
<h3 id="can_join/1">can_join(From::jid(), Nick::string(), Affiliation::atom(), ServiceAffiliation::atom(), Lang::string(), Packet, Headers::headers()) -&gt; {true, Role} | {false, Reason}</h3>

<ul class="type">
<li><code>Packet = string()</code></li></ul>
<div class="description">

<p>Deciding if the user can join the room.
   Affiliation is the affiliation specific to the room.
   ServiceAffiliation is specified in ejabberd's configuration file.
   Return true and given</p>
</div></div>
<div class="function">
<h3 id="can_invite/6">can_invite(From, FAffiliation, JID, InviteEl, Lang, Headers) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="can_get_full_jids/1">can_get_full_jids(UserInfo::user(), Headers::headers()) -&gt; true | false</h3>


<div class="description">

<p>Can the user see the real JID ?</p>
</div></div>
<div class="function">
<h3 id="allow_nick_change/1">allow_nick_change(From::jid(), Headers::headers()) -&gt; true | false</h3>


<div class="description">

<p>Can user change nickname ?</p>
</div></div>
<div class="function">
<h3 id="can_change_ra/1">can_change_ra(FAffiliation::atom(), FRole::atom(), TAffiliation::atom(), TRole::atom(), Type, Value, ServiceAf::atom(), Headers::headers()) -&gt; true | false | check_owner | nothing</h3>

<ul class="type">
<li><code>Type = affiliation | role</code></li><li><code>Value = atom()</code></li></ul>
<div class="description">

<p>Rules checking is user can change affiliations or roles.
  FAffiliation and FRole are the role/affiliation of the user operating the change
  TAffiliation and TRole are the role/affiliation of the recipient
  Value is the new value for the Type (role or affiliation)
  ServiceAf is the ServiceAffiliation of the recipient
  returns true or false. Also returns nothing is the role/affiliation has not changed.
  Can also return check_owner (TBD : still not sure why it's necessary)</p>
</div></div>
<div class="function">
<h3 id="list_to_affiliation/2">list_to_affiliation(StrAff::string, Headers::headers) -&gt; atom()</h3>


<div class="description">

<p>Convert string Affiliation (from a stanza) to its atom form (for management).</p>
</div></div>
<div class="function">
<h3 id="list_to_role/2">list_to_role(StrRole::string, Headers::headers) -&gt; atom()</h3>


<div class="description">

<p>Convert string Role (from a stanza) to its atom form (for management).</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
