<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>cpx_agent_tcp_connection (openacd) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>cpx_agent_tcp_connection</h1>
<h2 class="modsummary">The connection handler that communicates with a client UI over tcp
  using json as the encoding mechanism.</h2>
<div class="description">
<p>The connection handler that communicates with a client UI over tcp
  using json as the encoding mechanism.  Works as a go between the wire
  and <url href="/home/pete/wefwefwef/docs/other/da213c916b436fb60780c76c0838b382f62bc90c/repo/embeddable_build/.xml/openacd/./cpx_agent_connection.xml">cpx_agent_connection</url>.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-compression">compression() = zip | gzip | none</h3></div>
    <div class="type"><h3 id="type-json">json() = {struct, [{binary(), <a href="#type-json" class="seealso">json()</a>}]}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| binary()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| integer()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| float()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<a href="#type-json" class="seealso">json()</a>]</h3></div>
    <div class="type"><h3 id="type-socket_type">socket_type() = tcp | ssl</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start/1">start(Socket::port(), SocketMod::socket_type(), Radix::pos_integer(), Compress::compression()) -&gt; {ok, pid()}</h3>


<div class="description">

<p>start the conection unlinked.</p>
</div></div>
<div class="function">
<h3 id="start_link/1">start_link(Socket::port(), SocketMod::socket_type(), Radix::pos_integer(), Compress::compression()) -&gt; {ok, pid()}</h3>


<div class="description">

<p>start the conection linked to calling process.</p>
</div></div>
<div class="function">
<h3 id="negotiate/1">negotiate(Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Notify the connection that it should set the socket to recieve
  requets, and sent events to the client.</p>
</div></div>
<div class="function">
<h3 id="check_version/1">check_version(State::#state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}, Major::pos_integer(), Minor::pos_integer()) -&gt; {ok, #state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}} | {ok, json(), #state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}} | {exit, binary(), binary(), #state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}}</h3>


<div class="description">

<p>?? Step one in logging in:  ensure the client version is in the same
  ballpark as the server.  Differenences in the minor version are
  tolerated, major version differences are not.  If the minor version
  does not match, the result object is a string saying as much, otherwise
  returns a simple success.</p>
</div></div>
<div class="function">
<h3 id="get_nonce/1">get_nonce(State::#state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}) -&gt; {exit, binary(), binary(), #state{agent_conn_state=undefined | any(), socket=any(), socket_mod=any(), compression=any(), netstring=any(), client_errs=any(), err_threshold=any(), version_check=any(), nonce=any()}}</h3>


<div class="description">

<p>?? get the public key and nonce to encrypt the password.
  This can be skipped when using an ssl connection.  Sent back is a none,
  the public key exponent (pubkey_e) and public key modulus (pubkey_n).
  Use the exponent and modulus to build a public key.  Prepend the
  password with the nonce.  Then encrypt it with the public key.  The
  encrypted password is used in the next <a href="#login/3" class="seealso">login step</a>.</p>
</div></div>
<div class="function">
<h3 id="login/3">login(State, Username, Password) -&gt; term()
</h3>


<div class="description">

<p>?? Final step in logging in.  If the connection is over
  raw tcp, the password must be encrypted using the information gleaned
  from <a href="#get_nonce/1" class="seealso">get_nonce/1</a>.  Returns a simple representation of the agent
  that was created.</p>
</div></div></div>
<div class="section"><h4>See also</h4><p><a href="cpx_agent_tcp_listener.html" class="seealso">cpx_agent_tcp_listener</a></p></div>
<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
