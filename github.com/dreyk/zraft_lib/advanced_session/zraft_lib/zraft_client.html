<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>zraft_client (zraft_lib) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>zraft_client</h1>
<h2 class="modsummary"/>
<div class="description">
</div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-apply_conf_error">apply_conf_error() = leader_changed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| not_stable<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| newer_exists<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| process_prev_change<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| timeout</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="light_session/1">light_session(Conf) -&gt; light_session() (see module zraft_session_obj) | {error, Reason}</h3>

<ul class="type">
<li><code>Conf = [peer_id() (see module zraft_consensus)] | peer_id() (see module zraft_consensus)</code></li><li><code>Reason = no_peers | term()</code></li></ul>
<div class="description">

<p>Create light session for read/write operations.</p>
</div></div>
<div class="function">
<h3 id="light_session/3">light_session(Conf, BackOff, Election) -&gt; light_session() (see module zraft_session_obj) | {error, Reason}</h3>

<ul class="type">
<li><code>Conf = [peer_id() (see module zraft_consensus)] | peer_id() (see module zraft_consensus)</code></li><li><code>BackOff = timeout()</code></li><li><code>Election = timeout()</code></li><li><code>Reason = no_peers | term()</code></li></ul>
<div class="description">

<p>Create light session for read/write operations</p>
 
  <p>Use it for create object that will be used to batch read/write operation.</p>
 
  <p>If Conf is single PeerID then quorum configuration will be read.  
In that case it may return error.</p>
 
  <p>You must crate new object scine you know that quorum configuration has been changed.</p>
 
  <p>If Conf is empty list then  {error,no_peers} will be returned.</p>
</div></div>
<div class="function">
<h3 id="query/3">query(Raft, Query, Timeout) -&gt; {Result, NewRaftConf} | RuntimeError</h3>

<ul class="type">
<li><code>Raft = light_session() (see module zraft_session_obj) | peer_id() (see module zraft_consensus)</code></li><li><code>Query = term()</code></li><li><code>Timeout = timeout()</code></li><li><code>Result = term()</code></li><li><code>NewRaftConf = light_session() (see module zraft_session_obj) | peer_id() (see module zraft_consensus)</code></li><li><code>RuntimeError = {error, timeout} | {error, noproc}</code></li></ul>
<div class="description">

<p>Read data from state machine.</p>
 
  <p>Query parameter value depends on backend type used for state machine.</p>
 
  <p>If Raft is single peer than it will try to read data from it. Request will be redirected to leader  
if that peer is follower or canditate. If peer is unreachable or is going down request will fail with error {error,noproc}.</p>
 
  <p>If Raft is light session object and current leader is going down it will retry requet to other peer and so on
  until receive respose or timeout.</p>
</div></div>
<div class="function">
<h3 id="write/3">write(Raft, Data, Timeout) -&gt; {Result, NewRaftConf} | RuntimeError</h3>

<ul class="type">
<li><code>Raft = light_session() (see module zraft_session_obj) | peer_id() (see module zraft_consensus)</code></li><li><code>Data = term()</code></li><li><code>Timeout = timeout()</code></li><li><code>Result = term()</code></li><li><code>NewRaftConf = light_session() (see module zraft_session_obj) | peer_id() (see module zraft_consensus)</code></li><li><code>RuntimeError = {error, timeout} | {error, noproc}</code></li></ul>
<div class="description">

<p>Write data to state machine.</p>
 
  <p>Data parameter value depends on backend type used for state machine.</p>
 
  <p>If Raft is single peer than it will try to write data from it. Request will be redirected to leader  
if that peer is follower or canditate. If peer is unreachable or is going down request will fail with error {error,noproc}.</p>
 
  <p>If Raft is light session object and current leader is going down it will retry requet to other peer and so on
  until receive respose or timeout.</p>
</div></div>
<div class="function">
<h3 id="get_conf/1">get_conf(PeerID) -&gt; {ok, {Leader, Peers}} | {error, term()}</h3>

<ul class="type">
<li><code>PeerID = peer_id() (see module zraft_consensus)</code></li><li><code>Leader = peer_id() (see module zraft_consensus)</code></li><li><code>Peers = [peer_id() (see module zraft_consensus)]</code></li></ul>
<div class="description">

<p>Read raft consensus configuaration.</p>
</div></div>
<div class="function">
<h3 id="get_conf/2">get_conf(PeerID, Timeout) -&gt; {ok, {Leader, Peers}} | {error, term()}</h3>

<ul class="type">
<li><code>PeerID = peer_id() (see module zraft_consensus)</code></li><li><code>Timeout = timeout()</code></li><li><code>Leader = peer_id() (see module zraft_consensus)</code></li><li><code>Peers = [peer_id() (see module zraft_consensus)]</code></li></ul>
<div class="description">

<p>Read raft consensus configuaration.</p>
 
  <p>PeerID may be any peer in quorum. If it's not a leader, request will be redirected to the current leader
  If leader losts lidership or goes down during execution it may return runtime error or {error,timeout}.
  In that case you may retry request.</p>
</div></div>
<div class="function">
<h3 id="create/2">create(Peers, BackEnd) -&gt; {ok, ResultPeers} | {error, term()}</h3>

<ul class="type">
<li><code>Peers = [peer_id() (see module zraft_consensus)]</code></li><li><code>BackEnd = module()</code></li><li><code>ResultPeers = [peer_id() (see module zraft_consensus)]</code></li></ul>
<div class="description">

<p>Create new quorum.</p>
</div></div>
<div class="function">
<h3 id="create/3">create(FirstPeer, Peers, BackEnd) -&gt; {ok, ResultPeers} | {error, StartError | StartErrors} | {error, ApplyConfError}</h3>

<ul class="type">
<li><code>FirstPeer = peer_id() (see module zraft_consensus)</code></li><li><code>Peers = [peer_id() (see module zraft_consensus)]</code></li><li><code>BackEnd = module()</code></li><li><code>ResultPeers = [peer_id() (see module zraft_consensus)]</code></li><li><code>StartError = {peer_id() (see module zraft_consensus), already_present | nodedown, term()}</code></li><li><code>StartErrors = [StartError]</code></li><li><code>ApplyConfError = apply_conf_error()</code></li></ul>
<div class="description">

<p>Create new quorum.</p>
 
  <p>First it will be initialized FirstPeer. After that all other peers will be started and new configuration  
will be applied to the FirstPeer and replicated to other.</p>
 
  <p>It returns error in following cases:</p>
 
  <p>1. Some peer has been alredy started or can't be started</p>
 
  <p>2. Can't apply new configuration to peers.</p>
</div></div>
<div class="function">
<h3 id="check_exists/1">check_exists(Peer::peer_id() (see module zraft_consensus)) -&gt; ok | {error, exists}</h3>


<div class="description">
 </div></div></div>

<authors>

<aname>Gunin Alexander</aname>
<email>guninalexander@gmail.com</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
