<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>yapp (yapp) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>yapp</h1>
<h2 class="modsummary">Yaws applications handler.</h2>
<div class="description">
<p>Yaws applications handler.
   </p><p>An easy way to deploy Yaws applications independently of
   each other.</p>
   <p>This module implements Yaws runmod and arg_rewrite_mod interfaces.
   It has functions to insert and remove Yapps to the Yaws sconfs records.
   It is used by the yapp_handler implementation. The yapp module will make Yaws
   temporarily switch the docroot
   to the applications priv/docroot directory when it encounters the registered
   URL path of the application. One can set another docroot than the default
    (priv/docroot) by setting the environment variable yapp_docroot in the
   .app file for the application.
   The application may also have own appmods which are put in the
   application environment variable yapp_appmods like: </p>
   <code>  {env, [
           {yapp_appmods,[{"ctrl",enityme_controller}]}
          ]}, </code>
   <p>
   In order to include the yapp module, runmod shall be set to yapp.
   The arg_rewrite_mod shall also be set to yapp and the opaque variable
   yapp_server_id shall be set to an unique string for every virtual server
   using yapp, like: </p>
   <pre class="sh_erlang">
   .
   ebin_dir = /usr/local/yaws/lib/yapp/ebin
   .
   runmod = yapp
   .
   &lt;server aspen4&gt;
          port = 8001
          listen = 0.0.0.0
          dir_listings = true
          arg_rewrite_mod = yapp
          docroot = /home/yaws/scripts/../www
          &lt;opaque&gt;
                  yapp_server_id = aspeninternal
                  bootstrap_yapps = yapp
          &lt;/opaque&gt;
   &lt;/server&gt;
   </pre>
  
   <p><em>Note:</em> The yapp application is in itself a "Yapp" with a small admin console.
   So by adding the line <code>bootstrap_yapps = yapp</code> as above you will get access
   to the admin console on http://yourservername/yapp/index.html</p>
   <p><em>Note2:</em> The current available registry implementation uses Mnesia so you need
   to create a mnesia schema (if not already done) for the node(s) you are running Yaws on.
   <code>mnesia:create_schema([node()]).</code></p>
  </div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-yawsArg">yawsArg() = term()</h3></div>
    <div class="type"><h3 id="type-yawsGconf">yawsGconf() = term()</h3></div>
    <div class="type"><h3 id="type-yawsSconf">yawsSconf() = term()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="arg_rewrite/1">arg_rewrite(Arg::yawsArg()) -&gt; yawsArg()</h3>


<div class="description">

<p>Interface function for a Yaws arg_rewrite_mod. If
  it finds a registered Yapp it will strip of the
  path up to the Yapp and redirect the docroot.</p>
</div></div>
<div class="function">
<h3 id="start/0">start() -&gt; void()</h3>


<div class="description">

<p>Interface function for Yaws run_mod.
  This fun is spawned from Yaws so no return val is expected.
  All Yapps can expect mnesia to be started, so mnesia is ensured
  to be started.
  For every server id that has Yapps the yapp module is registered
  as an arg_rewrite_mod in #sconf.
  Configuration data for mapping Yapp paths to applications is looked
  up in a mnesia registry table and stored in Yaws #sconf.opaque record
  for the each server id.</p>
</div></div>
<div class="function">
<h3 id="prepath/1">prepath(Arg::yawsArg()) -&gt; Path::string()</h3>


<div class="description">

<p>Get the Yapp root-path. Can be called from a Yapp erl/1
  fun or an erl section in a .yaws file to get the Yapp root
  path.</p>
</div></div>
<div class="function">
<h3 id="log/2">log(Level, FormatStr::string(), Args) -&gt; void()</h3>

<ul class="type">
<li><code>Level = error | warning | info | debug</code></li><li><code>Args = [term()]</code></li></ul>
<div class="description">

<p>Yapp interface to the error_logger.</p>
</div></div>
<div class="function">
<h3 id="reset_yaws_conf/0">reset_yaws_conf() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="srv_id/1">srv_id(Sconf) -&gt; string() | undefined</h3>

<ul class="type">
<li><code>Sconf = yawsSconf()</code></li></ul>
<div class="description">

<p>Get the server id from an Sconf if available</p>
</div></div>
<div class="function">
<h3 id="get_bootstrap_yapps/0">get_bootstrap_yapps() -&gt; [{ServerId, [{Path, ApplicationName}]}]</h3>

<ul class="type">
<li><code>ServerId = string()</code></li><li><code>Path = string()</code></li><li><code>Applicationame = atom()</code></li></ul>
<div class="description">

<p>Gets the Yapps defined in each opaque
  "bootstrap_yapps = appname1, appname2" for every server id. (If available).
  Bootstrap yapps will get the same pathname as their application name
  and are "static" meaning that they can not be removed from the server
  unless yaws.conf is changed (or if embedded yaws - yaws:setconf/2 is used).</p>
</div></div>
<div class="function">
<h3 id="get_yapps/0">get_yapps() -&gt; [{ServId, [{yapp, Urlpath, Docroot, Appname, Appmods}]}]</h3>

<ul class="type">
<li><code>Urlpath = string()</code></li><li><code>Docroot = string()</code></li><li><code>Appname = atom()</code></li><li><code>Appmods = [atom()]</code></li></ul>
<div class="description">

<p>Gets all Yapps that are configured for the Yaws server.</p>
</div></div>
<div class="function">
<h3 id="get_server_ids/0">get_server_ids() -&gt; [string()]</h3>


<div class="description">

<p>Lists all server ids.</p>
</div></div></div>
<div class="section"><h4>See also</h4><p><a href="yapp_handler.html" class="seealso">yapp_handler</a></p></div>
<authors>

<aname>Mikael Karlsson</aname>
<email>mikael@creado.com</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
