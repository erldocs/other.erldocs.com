<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>mongrel (mongrel) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>mongrel</h1>
<h2 class="modsummary">Mongrel API.</h2>
<div class="description">
<p>Mongrel API. This module provides functions for creating, reading, updating and deleting
        documents. The functions exposed are similar to the CRUD functions exposed by the
        mongo API of the MongoDB driver. While the mongo functions take collection and document
        arguments, the mongrel functions expect one or more records as arguments.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-action">action() = function()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="count/1">count(SelectorRecord::record()) -&gt; integer()</h3>


<div class="description">

<p>Counts the number of documents that match some selector.</p>
</div></div>
<div class="function">
<h3 id="count/1-1">count(SelectorRecord::record(), Limit::integer()) -&gt; integer()</h3>


<div class="description">

<p>Counts the number of documents that match some selector up to a specified
       maximum. A limit of 0 means that all matching documents are counted.</p>
</div></div>
<div class="function">
<h3 id="delete/1">delete(SelectorRecord::record()) -&gt; ok</h3>


<div class="description">

<p>Deletes all documents that match a selector.</p>
</div></div>
<div class="function">
<h3 id="delete_one/1">delete_one(SelectorRecord::record()) -&gt; ok</h3>


<div class="description">

<p>Deletes the first document that matches a selector.</p>
</div></div>
<div class="function">
<h3 id="do/1">do(WriteMode::write_mode() (see module mongo), ReadMode::read_mode() (see module mongo), Connection::connection() (see module mongo) | rs_connection() (see module mongo), Database::db() (see module mongo), Action::action() (see module mongo)) -&gt; {ok, any()} | {failure, any()}</h3>


<div class="description">

<p>Executes an 'action' using the specified read and write modes to a database using a connection.
       An 'action' is a function that takes no arguments. The fun will usually invoke functions
       to do inserts, finds, modifies, deletes, etc.</p>
</div></div>
<div class="function">
<h3 id="find/1">find(SelectorRecord::record()) -&gt; cursor() (see module mongrel_cursor)</h3>


<div class="description">

<p>Finds all documents that match a selector and returns a cursor.</p>
</div></div>
<div class="function">
<h3 id="find/1-1">find(SelectorRecord::record(), ProjectorRecord::record()) -&gt; cursor() (see module mongrel_cursor)</h3>


<div class="description">

<p>Finds all documents that match a selector and returns a cursor
       of a projection. The projection can be passed as a mapped
       record or as a Mongo tuple consisting of alternating keys and values.
       An empty list ([]) indicates that the full projection of documents must
       be returned.</p>
</div></div>
<div class="function">
<h3 id="find/1-2">find(SelectorRecord::record(), ProjectorRecord::record(), Skip::integer()) -&gt; cursor() (see module mongrel_cursor)</h3>


<div class="description">

<p>Finds all documents that match a selector and returns a cursor
       of a projection result. A specified number of matching
       documents are skipped.</p>
</div></div>
<div class="function">
<h3 id="find/1-3">find(SelectorRecord::record(), ProjectorRecord::record(), Skip::integer(), BatchSize::integer()) -&gt; cursor() (see module mongrel_cursor)</h3>


<div class="description">

<p>Finds all documents that match a selector and returns a cursor
       of a projection result. A specified number of matching
       documents are skipped.  The cursor retrieves results in the specified batch size.</p>
</div></div>
<div class="function">
<h3 id="find_one/1">find_one(SelectorRecord::record()) -&gt; record() | {}</h3>


<div class="description">

<p>Finds the first document that matches a selector and returns the document as a record.</p>
</div></div>
<div class="function">
<h3 id="find_one/1-1">find_one(SelectorRecord::record(), ProjectorRecord::record() | tuple()) -&gt; record() | {}</h3>


<div class="description">

<p>Finds the first document that matches a selector and returns a
       projection of the document. The empty projection ([]) means
       that all fields in the document are populated.  The projection can be
       passed as a mapped record or as a Mongo tuple consisting of alternating
       keys and values.</p>
</div></div>
<div class="function">
<h3 id="find_one/1-2">find_one(SelectorRecord::record(), ProjectorRecord::record() | tuple(), Skip::integer()) -&gt; {record()}</h3>


<div class="description">

<p>Finds a document that matches a selector and returns a
       projection of the document after skipping a certain number of
       matching documents.</p>
</div></div>
<div class="function">
<h3 id="insert/1">insert(Record::record()) -&gt; value() (see module bson)</h3>


<div class="description">

<p>Inserts a record into a collection with the same name as the record type. If the
       record contains nested records with '_id' fields, the nested documents are upserted
       into their appropriate collections as well. The ID of the inserted document is
       returned.</p>
</div></div>
<div class="function">
<h3 id="insert_all/1">insert_all(Records::[record()]) -&gt; [value() (see module bson)]</h3>


<div class="description">

<p>Inserts a list of records into collections with the same name as the corresponding
       record type. If a record contains nested records with '_id' fields, the nested documents are
       upserted into their appropriate collections as well. A list of IDs of the inserted documents is
       returned.</p>
</div></div>
<div class="function">
<h3 id="modify/1">modify(SelectorRecord::record(), ModifierRecord::record()) -&gt; ok</h3>


<div class="description">

<p>Updates selected documents using a modifier. The modifier can be specified as a {key, value}
       tuple where the key is a modifier and the value is a mapped record (e.g {'$set', #foo{bar=3}})
       or as a mongo modifier tuple (e.g. {'$set', {bar, 3}).</p>
</div></div>
<div class="function">
<h3 id="replace/1">replace(SelectorRecord::record(), NewRecord::record()) -&gt; ok</h3>


<div class="description">

<p>Replaces the first document that matches the selector with a new document.</p>
</div></div>
<div class="function">
<h3 id="repsert/1">repsert(SelectorRecord::record(), NewRecord::record()) -&gt; ok</h3>


<div class="description">

<p>Replaces the first document that matches the selector with a new document. If no
       document can be matched, the new document is inserted.</p>
</div></div>
<div class="function">
<h3 id="save/1">save(Record::record()) -&gt; ok</h3>


<div class="description">

<p>Upserts a record into a collection with the same name as the record type. If the
       record contains nested records with '_id' fields, the nested documents are upserted
       into their appropriate collections as well.</p>
</div></div>
<div class="function">
<h3 id="init/1">init(ConnectionParameters::[{write_mode() (see module mongo), read_mode() (see module mongo), connection() (see module mongo) | rs_connection() (see module mongo), db() (see module mongo), integer()}]) -&gt; {ok, State::#state{}}</h3>


<div class="description">

<p>Initializes the server with a write mode, read mode, a connection and database.
       The parameters are stored in the process dictionary so that they can be used
       if a connection is needed by a cursor to access collections.</p>
</div></div>
<div class="function">
<h3 id="handle_call/2">handle_call(Request::{do, action()}, From::pid(), State::#state{}) -&gt; {stop, normal, any(), #state{}}</h3>


<div class="description">

<p>Responds synchronously to server calls.  The action of the do/5 function is executed by
       this function. The process is stopped after this call.</p>
</div></div>
<div class="function">
<h3 id="handle_cast/1">handle_cast(Message::any(), State::#state{}) -&gt; {noreply, State::#state{}}</h3>


<div class="description">

<p>Responds asynchronously to messages. The server ignores any asynchronous messages.</p>
</div></div>
<div class="function">
<h3 id="handle_info/1">handle_info(Info::any(), State::#state{}) -&gt; {noreply, State::#state{}}</h3>


<div class="description">

<p>Responds to out-of-band messages. The server ignores any such messages.</p>
</div></div>
<div class="function">
<h3 id="terminate/1">terminate(Reason::any(), State::#state{}) -&gt; ok</h3>


<div class="description">

<p>Handles the shutdown of the server.</p>
</div></div>
<div class="function">
<h3 id="code_change/1">code_change(OldVersion::any(), State::#state{}, Extra::any()) -&gt; {ok, State::#state{}}</h3>


<div class="description">

<p>Responds to code changes. Any code changes are ignored (the server's state is unchanged).</p>
</div></div></div>

<authors>

<aname>CA Meijer</aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
