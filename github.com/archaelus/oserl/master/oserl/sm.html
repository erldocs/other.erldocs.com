<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>sm (oserl) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>sm</h1>
<h2 class="modsummary">Short Message Library Module.</h2>
<div class="description">
<p>Short Message Library Module.</p>
  
   <p>Utility functions for short messages on SMPP requests/responses.</p>
  
  
   <em>Changes 0.1 -&gt; 0.2</em>
  
   <p>[10 Feb 2004]</p>
  
   <list>
     <item><p>Calls to <code>pdu_syntax:get_value/2</code> replaced by
       <code>operation:get_param/2</code>.
     </p></item>
   </list>
  
   <em>Changes 0.2 -&gt; 1.2</em>
  
   <p>[13 Feb 2005]</p>
  
   <list>
     <item><p>Functions <a href="#reply_destination_address/1" class="seealso">
       reply_destination_address/1</a>, <a href="#reply_source_address/1" class="seealso">
       reply_source_address/1</a> and <a href="#reply_address/1" class="seealso">
       reply_addresses/1</a> added.</p>
  
       <a href="#reply_address/1" class="seealso">reply_address/1</a> will be removed, use
       <a href="#reply_destination_address/1" class="seealso">reply_destination_address/1</a>
       instead.
     </item>
   </list>
  
   <p>[7 Abr 2005]</p>
  
   <p>Add support for message concatenation.</p>
  
   <list>
     <item><p>Functions <a href="#set_udhi/1" class="seealso">set_udhi/1</a> and
       <a href="#split_user_data/2" class="seealso">split_user_data/2</a> added.
     </p></item>
   </list>
  
   <p>[11 Abr 2005]</p>
  
   <p>Add support for message concatenation.</p>
  
   <list>
     <item><p>Function set_udhi/1 replaced by <a href="#udhi/2" class="seealso">udhi/2</a>.</p></item>
     <item><p>Function <a href="#udhi/1" class="seealso">udhi/1</a> implemented.</p></item>
     <item><p>Function <a href="#chop_udh/1" class="seealso">chop_udh/1</a> implemented.</p></item>
     <item><p>Function <a href="#reference_number/1" class="seealso">reference_number/1</a>
       implemented.
     </p></item>
     <item><p>Function <a href="#join_user_data/1" class="seealso">join_user_data/1</a> added.
     </p></item>
     <item><p>Function <a href="#total_segments/1" class="seealso">total_segments/1</a>
       implemented.
     </p></item>
   </list>
  
   <p>[11 Jul 2005]</p>
  
   <p>Add support for message concatenation.</p>
  
   <list>
     <item><p>Function <a href="#split_user_data_tlv/1" class="seealso">split_user_data_tlv/1</a>
       added.
     </p></item>
   </list>
  
   <em>Changes 1.2 -&gt; 1.3</em>
  
   <p>[20 Sep 2006]</p>
  
   <p>Improve support for message concatenation and support for application
   port addressing.</p>
  
   <list>
     <item><p>Function <i>reply_address/1</i> removed.
     </p></item>
   </list>
  
   <em>Changes 1.3 -&gt; 1.4</em>
  
   <p>[9 Aug 2007]</p>
  
   <list>
     <item><p>The function <i>message_user_data/2</i> now searches for
       <code>message_payload</code> parameter first.
     </p></item>
   </list>
  
  </div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="add_ie/2">add_ie(ParamList, Ie) -&gt; NewParamList</h3>

<ul class="type">
<li><code>ParamList = [{ParamName, ParamValue}]</code></li><li><code>Ie = string()</code></li><li><code>NewParamList = ParamList</code></li></ul>
<div class="description">

<p>Adds an Information Element to the User Data Header.  If needed the
  User Data Header Indicator is set.  A <code>NewParamList</code> is returned.</p>
</div></div>
<div class="function">
<h3 id="chop_udh/1">chop_udh(Data) -&gt; {Udh, Rest}</h3>

<ul class="type">
<li><code>Data = string()</code></li><li><code>Rest = string()</code></li><li><code>Udh = string()</code></li></ul>
<div class="description">

<p>Chops the User Data Header from the User Data of a short message.</p>
</div></div>
<div class="function">
<h3 id="destination_port/1">destination_port(Pdu) -&gt; DestinationPort</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>DestinationPort = int()</code></li></ul>
<div class="description">

<p>Returns the <code>DestinationPort</code> of an Application Port Addressed  
Short Message.</p>
 
  <p>The function will fail if <code>Pdu</code> does not correspond with a valid
  Application Port Addressed message.</p>
</div></div>
<div class="function">
<h3 id="ie/2">ie(Iei, T::Udh) -&gt; Ie</h3>

<ul class="type">
<li><code>Iei = int()</code></li><li><code>Udh = string()</code></li><li><code>Ie = string()</code></li></ul>
<div class="description">

<p>Returns the Information Element in the User Data Header identified by
  <code>Iei</code>.  If no IE found for the given id the function crashes.</p>
</div></div>
<div class="function">
<h3 id="join_user_data/1">join_user_data(Segments) -&gt; {Data, RefNum}</h3>

<ul class="type">
<li><code>Segments = [Segment]</code></li><li><code>Segment = string()</code></li><li><code>Data = string()</code></li><li><code>RefNum = int()</code></li></ul>
<div class="description">

<p>Joins the <code>Segments</code> of a concatenated message.</p>
 
  <p>This functions assumes that no other IE than concatenation IE is present
  in the segments UDH, otherwise resulting <code>Data</code> will be corrupted.</p>
 
<p><em>See also:</em> <a href="#split_user_data/2" class="seealso">split_user_data/2</a>.</p>
</div></div>
<div class="function">
<h3 id="message_user_data/1">message_user_data(ParamList::Pdu) -&gt; UserData</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>UserData = {ParamName, ParamValue}</code></li><li><code>ParamName = short_message | message_payload</code></li><li><code>ParamValue = undefined | string()</code></li></ul>
<div class="description">

<p>Gets the message user data from a PDU.  The message user data may came
  in the <i>short_message</i> or in the <i>message_payload</i> parameter.</p>
</div></div>
<div class="function">
<h3 id="originator_port/1">originator_port(Pdu) -&gt; OriginatorPort</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>OriginatorPort = int()</code></li></ul>
<div class="description">

<p>Returns the <code>OriginatorPort</code> of an Application Port Addressed  
Short Message.</p>
 
  <p>The function will fail if <code>Pdu</code> does not correspond with a valid
  Application Port Addressed message.</p>
</div></div>
<div class="function">
<h3 id="port_addressing_8/3">port_addressing_8(ParamList, DestPort, OrigPort) -&gt; NewParamList</h3>

<ul class="type">
<li><code>Data = string()</code></li><li><code>DestPort = int()</code></li><li><code>OrigPort = int()</code></li><li><code>NewData = string()</code></li></ul>
<div class="description">

<p>Adds application port addressing 8 bit address header to the message
  user data.</p>
</div></div>
<div class="function">
<h3 id="port_addressing_16/3">port_addressing_16(ParamList, DestPort, OrigPort) -&gt; NewParamList</h3>

<ul class="type">
<li><code>Data = string()</code></li><li><code>DestPort = int()</code></li><li><code>OrigPort = int()</code></li><li><code>NewData = string()</code></li></ul>
<div class="description">

<p>Adds application port addressing 16 bit address header to the message
  user data.</p>
</div></div>
<div class="function">
<h3 id="reference_number/1">reference_number(Pdu) -&gt; ReferenceNumber</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>ReferenceNumber = int()</code></li></ul>
<div class="description">

<p>Returns the <code>ReferenceNumber</code> of a concatenated message.</p>
 
  <p>The function will fail if <code>Pdu</code> does not correspond with a valid
  concatenated message.</p>
</div></div>
<div class="function">
<h3 id="reply_addresses/1">reply_addresses(Pdu) -&gt; ParamList</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>ParamList = [DestAddrTon | [DestAddrNpi | [DestinationAddr]]]</code></li><li><code>DestAddrTon = {dest_addr_ton, int()}</code></li><li><code>DestAddrNpi = {dest_addr_npi, int()}</code></li><li><code>DestinationAddr = {destination_addr, string()}</code></li></ul>
<div class="description">

<p>Creates reply addresses (<i>dest_addr_ton</i>, <i>dest_addr_npi</i>,
  <i>destination_addr</i>, <i>source_addr_ton</i>, <i>source_addr_npi</i>
  and <i>source_addr</i>) from the source address and destination address
  given in <code>Pdu</code>.</p>
</div></div>
<div class="function">
<h3 id="reply_destination_address/1">reply_destination_address(Pdu) -&gt; ParamList</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>ParamList = [DestAddrTon | [DestAddrNpi | [DestinationAddr]]]</code></li><li><code>DestAddrTon = {dest_addr_ton, int()}</code></li><li><code>DestAddrNpi = {dest_addr_npi, int()}</code></li><li><code>DestinationAddr = {destination_addr, string()}</code></li></ul>
<div class="description">

<p>Creates destination address parameters (<i>ton</i>, <i>npi</i> and
  <i>addr</i>) from the source address parameters of a given <code>Pdu</code>.</p>
</div></div>
<div class="function">
<h3 id="reply_source_address/1">reply_source_address(Pdu) -&gt; ParamList</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>ParamList = [DestAddrTon | [DestAddrNpi | [DestinationAddr]]]</code></li><li><code>DestAddrTon = {dest_addr_ton, int()}</code></li><li><code>DestAddrNpi = {dest_addr_npi, int()}</code></li><li><code>DestinationAddr = {destination_addr, string()}</code></li></ul>
<div class="description">

<p>Creates source address parameters (<i>ton</i>, <i>npi</i> and
  <i>addr</i>) from the destination address parameters of a given
  <code>Pdu</code>.</p>
</div></div>
<div class="function">
<h3 id="split/3">split(ParamList, RefNum, X3::ConcatenationMethod) -&gt; ParamListList</h3>

<ul class="type">
<li><code>ParamList = [{ParamName, ParamValue}]</code></li><li><code>ParamName = atom()</code></li><li><code>ParamValue = term()</code></li><li><code>RefNum = int()</code></li><li><code>ConcatenationMethod = udh | tlv</code></li><li><code>ParamListList = [ParamList]</code></li></ul>
<div class="description">

<p>Returns a list with a <code>ParamList</code> for every segment of
  a concatenated short message.</p>
</div></div>
<div class="function">
<h3 id="split_user_data/2">split_user_data(Data, RefNum) -&gt; Segments</h3>

<ul class="type">
<li><code>Data = string()</code></li><li><code>RefNum = int()</code></li><li><code>Segments = [Segment]</code></li><li><code>Segment = string()</code></li></ul>
<div class="description">

<p>Splits the user <code>Data</code> into <code>Segments</code> for concatenation.
  Returned <code>Segments</code> have the appropriated UDH.</p>
 
  <p>This functions assumes that no UDH is present in <code>Data</code>, if so
  resulting <code>Segments</code> will be corrupted.</p>
</div></div>
<div class="function">
<h3 id="total_segments/1">total_segments(Pdu) -&gt; TotalSegments</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li><li><code>TotalSegments = int()</code></li></ul>
<div class="description">

<p>Returns the total number of segments on a concatenated message.</p>
 
  <p>The function will fail if <code>Pdu</code> does not correspond with a valid
  concatenated message.</p>
</div></div>
<div class="function">
<h3 id="udhi/1">udhi(ParamList::Pdu) -&gt; bool()</h3>

<ul class="type">
<li><code>Pdu = pdu()</code></li></ul>
<div class="description">

<p>Returns <code>true</code> if UDHI is set, <code>false</code> otherwise.</p>
</div></div>
<div class="function">
<h3 id="udhi/2">udhi(ParamList, Udhi) -&gt; NewParamList</h3>

<ul class="type">
<li><code>ParamList = [{ParamName, ParamValue}]</code></li><li><code>ParamName = atom()</code></li><li><code>ParamValue = term()</code></li><li><code>Udhi = bool()</code></li></ul>
<div class="description">

<p>Sets <code>Udhi</code> in the <i>esm_class</i> parameter of given list.
  If <code>Udhi</code> is <code>true</code> UDHI is set to 1, when <code>false</code> sets  
the UDHI to 0.</p>
 
  <p>If <i>esm_class</i> parameter was not defined, returned list includes this
  parameter with a value of <code>ESM_CLASS_GSM_UDHI</code> if and only
  <code>Udhi</code> is <code>true</code>, if <code>Udhi</code> is <code>false</code>
  <i>esm_class</i> will be left undefined.</p>
</div></div></div>

<authors>

<aname>Enrique Marcote Pe√±a</aname>
<email>mpquique_at_users.sourceforge.net</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
