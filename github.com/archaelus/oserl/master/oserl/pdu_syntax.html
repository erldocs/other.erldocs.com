<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>pdu_syntax (oserl) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>pdu_syntax</h1>
<h2 class="modsummary">SMPP PDU Library.</h2>
<div class="description">
<p>SMPP PDU Library</p>
  
   <p>Library functions for the SMPP PDU manipulation.</p>
  
  
   <em>Changes 0.1 -&gt; 0.2</em>
  
   <p>[10 Feb 2004]</p>
  
   <list>
     <item><p>Removed <code>pdu_syntax:get_value/2</code> and <code>
       pdu_syntax:set_value/3</code>.  Using dictionary API instead.<br />
       <br />
       pdu_syntax functions are no longer used beyond operation API.
      </p></item>
   </list>
  
   <p>[01 Mar 2004]</p>
  
   <list>
     <item><p><i>command_id</i> is now included into the PDU descriptor.</p></item>
     <item><p>New functions <a href="#command_id/1" class="seealso">command_id/1</a> and.
       <a href="#sequence_number/1" class="seealso">sequence_number/1</a>
     </p></item>
   </list>
  
  
   <em>Changes 0.2 -&gt; 1.2</em>
  
   <p>[13 Jul 2004]</p>
  
   <list>
     <item><p>Condition <code>CommandId</code> of <code>16#800000000</code> removed from
       guards in functions <a href="#pack/2" class="seealso">pack/2</a> and
       <a href="#unpack/2" class="seealso">unpack/2</a>.
       <br />
       There was one 0 too many on that conditions.
       <br />
       Now the command_status is assumed to be always 0 on request PDUs.
      </p></item>
   </list>
  
   <p>[7 May 2005]</p>
  
   <list>
     <item><p>Function <a href="#command_status/1" class="seealso">command_status/1</a> added.</p></item>
   </list>
  
   <p>[7 Jul 2005]</p>
  
   <list>
     <item><p>Small change in <a href="#unpack_tlvs/2" class="seealso">unpack_tlvs/2</a>.  Now
       call <a href="#unpack_tlvs/3" class="seealso">unpack_tlvs/3</a> instead of looping
       back to <a href="#unpack_tlvs/2" class="seealso">unpack_tlvs/2</a> when discarding
       unsupported TLVs.
     </p></item>
   </list>
  
   <p>[30 Jul 2005 Anders Nygren]</p>
  
   <list>
     <item><p>Do not build a binary in <a href="#pack/2" class="seealso">pack/2</a>,
         build an iolist, it is more efficient.
     </p></item>
     <item><p>pack_tlvs, there is no need to reverse the list of TLVs. According to
         SMPP 5.0, 3.2.1.6 TLV Parameters they can be in any order.
     </p></item>
     <item><p>unpack_stds and unpack_tlvs, there is no need to reverse the list
         of parameters. The list of parameters will be converted to a dictionary.
     </p></item>
   </list><p>   
[5 Aug 2005 Anders Nygren]</p>
  
   <list>
     <item><p>Fix bug in pack/2, there is no BIF to find the length of
         an io_list, so it is still necessary to convert the message
         body to a binary in order to calculate the PDU length.
     </p></item>
   </list></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="command_id/1">command_id(PduDict::Pdu) -&gt; int()</h3>

<ul class="type">
<li><code>Pdu = bin() | dictionary()</code></li></ul>
<div class="description">

<p>Gets the <i>command_id</i> of a PDU (binary or dictionary).</p>
 
  <p>If the PDU is malformed and the <i>command_id</i> can not be found, the
  function crashes.</p>
</div></div>
<div class="function">
<h3 id="command_status/1">command_status(PduDict::Pdu) -&gt; int()</h3>

<ul class="type">
<li><code>Pdu = bin() | dictionary()</code></li></ul>
<div class="description">

<p>Gets the <i>command_status</i> of a PDU (binary or dictionary).</p>
 
  <p>If the PDU is malformed and the <i>command_status</i> can not be found,
  the function exits.</p>
</div></div>
<div class="function">
<h3 id="sequence_number/1">sequence_number(PduDict::Pdu) -&gt; int()</h3>

<ul class="type">
<li><code>Pdu = bin() | dictionary()</code></li></ul>
<div class="description">

<p>Gets the <i>sequence_number</i> of a PDU (binary or dictionary).</p>
 
  <p>If the PDU is malformed and the <i>sequence_number</i> can not be found,
  the function crashes.</p>
</div></div>
<div class="function">
<h3 id="new_pdu/4">new_pdu(CommandId, CommandStatus, SequenceNumber, Body) -&gt; PduDict</h3>

<ul class="type">
<li><code>CommandId = int()</code></li><li><code>CommandStatus = int()</code></li><li><code>SequenceNumber = int()</code></li><li><code>Body = [{Key, Value}]</code></li><li><code>PduDict = dictionary()</code></li></ul>
<div class="description">

<p>Creates a new PDU dictionary for a given the <code>CommandId</code>, a
  <code>CommandStatus</code>, <code>SequenceNumber</code> and a list of
  initial body values.  Every pair of the <code>Body</code> list must be on
  the form <code>{Key, Value}</code>.</p>
 
  <p>The <code>Body</code> parameter list is ignored whenever
  <code>CommandStatus</code> is different from 0.</p>
</div></div>
<div class="function">
<h3 id="pack/2">pack(PduDict, Type::PduType) -&gt; Result</h3>

<ul class="type">
<li><code>PduDict = dictionary()</code></li><li><code>PduType = {pdu, StdsTypes, TlvsTypes}</code></li><li><code>StdsTypes = [standard()]</code></li><li><code>TlvsTypes = [tlv()]</code></li><li><code>Result = {ok, BinaryPdu} | {error, CommandId, CommandStatus, SequenceNumber}</code></li><li><code>BinaryPdu = bin()</code></li><li><code>CommandId = CmdId | Other</code></li><li><code>Other = int()</code></li><li><code>CommandStatus = int()</code></li><li><code>SequenceNumber = int()</code></li></ul>
<div class="description">

<p>Packs an SMPP PDU dictionary into the corresponding byte stream
  given the <code>PduType</code>.</p>
 
  <p>This function generates an exception if <code>command_id</code>,
  <code>command_status</code>, <code>sequence_number</code> are not present
  on the PDU dictionary.</p>
 
  <p>Possible return values are:</p>
 
  <list>
    <item><p><code>{error, Other, ?ESME_RINVCMDID, SequenceNumber}</code> if the
      command_id on the <code>PduDict</code> is <code>Other</code> and doesn't
      match the command_id given as the parameter <code>CmdId</code>.
    </p></item>
    <item><p><code>{error, CmdId, CommandStatus, SequenceNumber}</code> where
      <code>CommandStatus</code> is <code> ?ESME_RUNKNOWNERR</code> or an
      error code associated to the parameter that caused the failure.  The
      command_id matches <code>CmdId</code> but a packing error was
      encountered.
    </p></item>
    <item><p><code>{ok, BinaryPdu}</code> if the PDU was successfully packed.
    </p></item>
  </list><p>
 </p>
<p><em>See also:</em> <a href="#pack_body/3" class="seealso">pack_body/3</a>.</p>
</div></div>
<div class="function">
<h3 id="unpack/2">unpack(BinaryPdu, Type::PduType) -&gt; Result</h3>

<ul class="type">
<li><code>BinaryPdu = bin()</code></li><li><code>PduType = {pdu, StdsTypes, TlvsTypes}</code></li><li><code>StdsTypes = [standard()]</code></li><li><code>TlvsTypes = [tlv()]</code></li><li><code>Result = {ok, PduDict} | {error, CommandId, CommandStatus, SequenceNumber}</code></li><li><code>PduDict = dictionary()</code></li><li><code>Error = int()</code></li><li><code>CommandId = undefined | int()</code></li><li><code>CommandStatus = int()</code></li><li><code>SequenceNumber = int()</code></li></ul>
<div class="description">

<p>Unpacks an SMPP Binary PDU (octet stream) into the corresponding
  PDU dictionary according to <code>PduType</code>.</p>
 
  <p>This function returns:</p>
 
  <list>
    <item><p><code>{error, CommandId, ?ESME_RINVCMDID, SequenceNumber}</code> if
      the command_id on the <code>PduDict</code> doesn't match the command_id
      given on <code>PduType</code>
    </p></item>
    <item><p><code>{error, CommandId, ?ESME_RINVCMDLEN, SequenceNumber}</code> if
      the PDU is malformed.  The <code>CommandId</code> might be the atom
      <code>undefined</code> and the <code>SequenceNumber</code> 0 if the
      PDU is completly unreadable.
    </p></item>
    <item><p><code>{error, CmdId, CommandStatus, SequenceNumber}</code> where
      <code>CommandStatus</code> is <code>?ESME_RUNKNOWNERR</code> or an error
      code associated to the parameter that caused the failure.  The
      <i>command_id</i> <code>CmdId</code> and the <code>SequenceNumber</code> are
      also included in the error report.
    </p></item>
    <item><p><code>{ok, PduDict}</code> if the PDU was successfully unpacked.
    </p></item>
  </list><p>
 </p>
<p><em>See also:</em> <a href="#unpack_body/3" class="seealso">unpack_body/3</a>.</p>
</div></div></div>

<authors>

<aname>Enrique Marcote Pe√±a</aname>
<email>mpquique_at_users.sourceforge.net</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
