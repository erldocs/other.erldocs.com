<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>riak_core_metadata_hashtree (riak_core) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>riak_core_metadata_hashtree</h1>
<h2 class="modsummary"/>
<div class="description">
</div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-metadata_key">metadata_key() = any()</h3></div>
    <div class="type"><h3 id="type-metadata_pkey">metadata_pkey() = {<a href="#type-metadata_prefix" class="seealso">metadata_prefix()</a>, <a href="#type-metadata_key" class="seealso">metadata_key()</a>}</h3></div>
    <div class="type"><h3 id="type-metadata_prefix">metadata_prefix() = {binary() | atom(), binary() | atom()}</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_link/0">start_link() -&gt; {ok, pid()} | ignore | {error, term()}</h3>


<div class="description">

<p>Starts the process using <a href="#start_link/1" class="seealso">start_link/1</a>, passing in the
  directory where other cluster metadata is stored in <code>platform_data_dir</code>
  as the data root.</p>
</div></div>
<div class="function">
<h3 id="start_link/1">start_link(DataRoot::filename() (see module file)) -&gt; {ok, pid()} | ignore | {error, term()}</h3>


<div class="description">

<p>Starts a registered process that manages a <a href="hashtree_tree.html" class="seealso">hashtree_tree</a> for Cluster Metadata. Data for the tree is stored,
  for the lifetime of the process (assuming it shutdowns gracefully),
  in the directory <code>DataRoot</code>.</p>
</div></div>
<div class="function">
<h3 id="insert/1">insert(PKey::metadata_pkey(), Hash::binary()) -&gt; ok</h3>


<div class="description">

<p>Same as insert(PKey, Hash, false).</p>
</div></div>
<div class="function">
<h3 id="insert/1-1">insert(PKey::metadata_pkey(), Hash::binary(), IfMissing::boolean()) -&gt; ok</h3>


<div class="description">

<p>Insert a hash for a full-prefix and key into the tree
  managed by the process. If <code>IfMissing</code> is <code>true</code> the hash is only
  inserted into the tree if the key is not already present.</p>
</div></div>
<div class="function">
<h3 id="prefix_hash/1">prefix_hash(Prefix::metadata_prefix() | binary() | atom()) -&gt; undefined | binary()</h3>


<div class="description">

<p>Return the hash for the given prefix or full-prefix</p>
</div></div>
<div class="function">
<h3 id="get_bucket/1">get_bucket(Node::node(), Prefixes::tree_node() (see module hashtree_tree), Level::non_neg_integer(), Bucket::non_neg_integer()) -&gt; orddict() (see module orddict)</h3>


<div class="description">

<p>Return the bucket for a node in the tree managed by this
  process running on <code>Node</code>.</p>
</div></div>
<div class="function">
<h3 id="key_hashes/1">key_hashes(Node::node(), Prefixes::tree_node() (see module hashtree_tree), Segment::non_neg_integer()) -&gt; orddict() (see module orddict)</h3>


<div class="description">

<p>Return the key hashes for a node in the tree managed by this
  process running on <code>Node</code>.</p>
</div></div>
<div class="function">
<h3 id="lock/0">lock() -&gt; ok | not_built | locked</h3>


<div class="description">

<p>??</p>
</div></div>
<div class="function">
<h3 id="lock/1">lock(Node::node()) -&gt; ok | not_built | locked</h3>


<div class="description">

<p>??.</p>
</div></div>
<div class="function">
<h3 id="lock/1-1">lock(Node::node(), Pid::pid()) -&gt; ok | not_built | locked</h3>


<div class="description">

<p>Lock the tree for updating. This function must be called
  before updating the tree with <a href="#update/0" class="seealso">update/0</a> or <a href="#update/1" class="seealso">update/1</a>. If the tree is not built or already locked then the call
  will fail and the appropriate atom is returned. Otherwise,
  aqcuiring the lock succeeds and <code>ok</code> is returned.</p>
</div></div>
<div class="function">
<h3 id="update/0">update() -&gt; ok | not_locked | not_built | ongoing_update</h3>


<div class="description">

<p>??.</p>
</div></div>
<div class="function">
<h3 id="update/1">update(Node::node()) -&gt; ok | not_locked | not_built | ongoing_update</h3>


<div class="description">

<p>Updates the tree on <code>Node</code>. The tree must be locked using one
  of the lock functions. If the tree is not locked or built the
  update will not be started and the appropriate atom is
  returned. Although this function should not be called without a
  lock, if it is and the tree is being updated by the background tick
  then <code>ongoing_update</code> is returned. If the tree is built and a lock
  has been acquired then the update is started and <code>ok</code> is
  returned. The update is performed asynchronously and does not block
  the process that manages the tree (e.g. future inserts).</p>
</div></div>
<div class="function">
<h3 id="compare/1">compare(RemoteFun::remote_fun() (see module hashtree_tree), HandlerFun::handler_fun(X) (see module hashtree_tree), X) -&gt; X</h3>


<div class="description">

<p>?? for
  more details on <code>RemoteFun</code>, <code>HandlerFun</code> and <code>HandlerAcc</code>.</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(X1, From, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_cast/2">handle_cast(Msg, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(X1, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="terminate/2">terminate(Reason, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="code_change/3">code_change(OldVsn, State, Extra) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
