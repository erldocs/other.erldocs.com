<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>riak_dt_vnode (riak_dt) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>riak_dt_vnode</h1>
<h2 class="modsummary"/>
<div class="description">
</div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-command">command() = #value{module = undefined | module(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key = undefined | binary(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req_id = undefined | integer() >= 1}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| #update{module = undefined | module(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key = undefined | binary(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args = undefined | [term()]}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| #merge{module = undefined | module(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key = undefined | binary(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value = undefined | {module(), term()},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req_id = undefined | integer() >= 1}</h3></div>
    <div class="type"><h3 id="type-key">key() = {Mod :: atom(), Key :: term()}</h3></div>
    <div class="type"><h3 id="type-partition">partition() = <a href="chash.html#type-index_as_int" class="seealso">chash:index_as_int()</a></h3></div>
    <div class="type"><h3 id="type-sender">sender() = {<a href="#type-sender_type" class="seealso">sender_type()</a>, reference() | tuple(), pid()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {server, undefined, undefined}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {fsm, undefined, pid()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ignore</h3></div>
    <div class="type"><h3 id="type-sender_type">sender_type() = fsm | server | raw</h3></div>
    <div class="type"><h3 id="type-vnode_req">vnode_req() = term()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_vnode/1">start_vnode(I::partition()) -&gt; {ok, pid()}</h3>


<div class="description">

<p>Starts or retrieves the pid of the riak_dt_vnode for the given
  partition index.</p>
</div></div>
<div class="function">
<h3 id="value/1">value(PrefList::preflist2() (see module riak_core_apl), Mod::module(), Key::term(), ReqId::term()) -&gt; ok</h3>


<div class="description">

<p>Retrieves the opaque value of the given data type and key.
  Used inside request FSMs.</p>
</div></div>
<div class="function">
<h3 id="update/1">update(IdxNode::partition(), Mod::module(), Key::term(), Args::term(), Timeout::pos_integer() | infinity) -&gt; ok</h3>


<div class="description">

<p>Updates the value of the specified data type on this index.</p>
</div></div>
<div class="function">
<h3 id="merge/1">merge(PrefList::preflist2() (see module riak_core_apl), Mod::module(), Key::term(), CRDT::term(), ReqId::term()) -&gt; ok</h3>


<div class="description">

<p>Sends a state to the indexes in the preflist to merge with
  their local states.</p>
</div></div>
<div class="function">
<h3 id="repair/1">repair(PrefList::preflist2() (see module riak_core_apl), Mod::module(), Key::term(), CRDT::term()) -&gt; ok</h3>


<div class="description">

<p>Sends a read-repair of a value, which amounts to a merge with
  no reply.</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1::[partition()]) -&gt; {ok, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Initializes the riak_dt_vnode.</p>
</div></div>
<div class="function">
<h3 id="handle_command/1">handle_command(Value::command(), Sender::sender(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {noreply, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}} | {reply, term(), #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Handles incoming vnode commands.</p>
</div></div>
<div class="function">
<h3 id="handle_handoff_command/1">handle_handoff_command(Riak_core_fold_req_v2::vnode_req(), Sender::sender(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {reply, term(), #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Handles commands while in the handoff state.</p>
</div></div>
<div class="function">
<h3 id="handoff_starting/1">handoff_starting(TargetNode::{partition(), node()}, State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {true, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Tells the vnode that handoff is starting.</p>
</div></div>
<div class="function">
<h3 id="handoff_cancelled/1">handoff_cancelled(State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {ok, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Tells the vnode that handoff was cancelled.</p>
</div></div>
<div class="function">
<h3 id="handoff_finished/2">handoff_finished(TargetNode::{partition, node()}, State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {ok, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Tells the vnode that handoff finished.</p>
</div></div>
<div class="function">
<h3 id="handle_handoff_data/1">handle_handoff_data(Binary::binary(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {reply, ok, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Decodes and receives a handoff value from the previous owner.
  For <code>riak_dt_vnode</code>, the semantics of this is equivalent to a merge
  command.</p>
</div></div>
<div class="function">
<h3 id="encode_handoff_item/1">encode_handoff_item(Name::key(), Value::term()) -&gt; binary()</h3>


<div class="description">

<p>Encodes a value to be sent over the wire in handoff.</p>
</div></div>
<div class="function">
<h3 id="is_empty/1">is_empty(State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {true | false, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Determines whether this vnode is empty, that is, has no data.</p>
</div></div>
<div class="function">
<h3 id="delete/1">delete(State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {ok, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Instructs the vnode to delete all its stored data.</p>
</div></div>
<div class="function">
<h3 id="handle_coverage/1">handle_coverage(Req::vnode_req(), KeySpaces::[{partition(), [partition()]}], Sender::sender(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {reply, not_implemented, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Handles coverage requests.</p>
</div></div>
<div class="function">
<h3 id="handle_exit/1">handle_exit(Pid::pid(), Reason::term(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; {noreply, #state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}}</h3>


<div class="description">

<p>Handles trapped exits from linked processes.</p>
</div></div>
<div class="function">
<h3 id="terminate/1">terminate(Reason::term(), State::#state{partition=undefined | partition(), node=undefined | node(), storage_state=undefined | term(), vnode_id=undefined | binary(), data_dir=undefined | filename() (see module file), storage_opts=undefined | [term()], handoff_target=undefined | node()}) -&gt; ok</h3>


<div class="description">

<p>Terminates the vnode.</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
