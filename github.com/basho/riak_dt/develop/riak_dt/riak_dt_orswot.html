<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>riak_dt_orswot (riak_dt) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>riak_dt_orswot</h1>
<h2 class="modsummary">An OR-Set CRDT.</h2>
<div class="description">
<p>An OR-Set CRDT. An OR-Set allows the adding, and removal, of
  elements. Should an add and remove be concurrent, the add wins. In
  this implementation there is a version vector for the whole set.
  When an element is added to the set, the version vector is
  incremented and the <code>{actor(), count()}</code> pair for that increment is
  stored against the element as its "birth dot". Every time the
  element is re-added to the set, its "birth dot" is updated to that
  of the <code>{actor(), count()}</code> version vector entry resulting from the  
add. When an element is removed, we simply drop it, no tombstones.</p>
 
  <p>When an element exists in replica A and not replica B, is it  
because A added it and B has not yet seen that, or that B removed  
it and A has not yet seen that? Usually the presence of a tombstone  
arbitrates. In this implementation we compare the "birth dot" of  
the present element to the clock in the Set it is absent from. If  
the element dot is not "seen" by the Set clock, that means the  
other set has yet to see this add, and the item is in the merged  
Set. If the Set clock dominates the dot, that means the other Set  
has removed this element already, and the item is not in the merged  
Set.</p>
 
  <p>Essentially we've made a dotted version vector.
 </p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-actor">actor() = <a href="riak_dt.html#type-actor" class="seealso">riak_dt:actor()</a></h3></div>
    <div class="type"><h3 id="type-any_orswot">any_orswot() = <a href="#type-v2_orswot" class="seealso">v2_orswot()</a> | <a href="#type-v2ord_orswot" class="seealso">v2ord_orswot()</a></h3></div>
    <div class="type"><h3 id="type-binary_orswot">binary_orswot() = binary()</h3></div>
    <div class="type"><h3 id="type-deferred">deferred() = <a href="#type-dict" class="seealso">dict</a>(<a href="riak_dt_vclock.html#type-vclock" class="seealso">riak_dt_vclock:vclock()</a>, [<a href="#type-member" class="seealso">member()</a>])</h3></div>
    <div class="type"><h3 id="type-dict">dict(_A, _B) = dict()</h3></div>
    <div class="type"><h3 id="type-dot">dot() = <a href="riak_dt.html#type-dot" class="seealso">riak_dt:dot()</a></h3></div>
    <div class="type"><h3 id="type-dots">dots() = [<a href="#type-dot" class="seealso">dot()</a>]</h3></div>
    <div class="type"><h3 id="type-entries">entries() = <a href="#type-dict" class="seealso">dict</a>(<a href="#type-member" class="seealso">member()</a>, <a href="#type-dots" class="seealso">dots()</a>)</h3></div>
    <div class="type"><h3 id="type-member">member() = term()</h3></div>
    <div class="type"><h3 id="type-orswot">orswot() = <a href="#type-v1_orswot" class="seealso">v1_orswot()</a> | <a href="#type-v2_orswot" class="seealso">v2_orswot()</a></h3></div>
    <div class="type"><h3 id="type-orswot_op">orswot_op() = {add, <a href="#type-member" class="seealso">member()</a>}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {remove, <a href="#type-member" class="seealso">member()</a>}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {add_all, [<a href="#type-member" class="seealso">member()</a>]}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {remove_all, [<a href="#type-member" class="seealso">member()</a>]}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {update, [<a href="#type-orswot_op" class="seealso">orswot_op()</a>]}</h3></div>
    <div class="type"><h3 id="type-orswot_q">orswot_q() = size | {contains, term()}</h3></div>
    <div class="type"><h3 id="type-precondition_error">precondition_error() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{error, {precondition, {not_present, <a href="#type-member" class="seealso">member()</a>}}}</h3></div>
    <div class="type"><h3 id="type-v1_orswot">v1_orswot() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="riak_dt_vclock.html#type-vclock" class="seealso">riak_dt_vclock:vclock()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="#type-member" class="seealso">member()</a>, <a href="#type-dots" class="seealso">dots()</a>},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="riak_dt_vclock.html#type-vclock" class="seealso">riak_dt_vclock:vclock()</a>, [<a href="#type-member" class="seealso">member()</a>]}}</h3></div>
    <div class="type"><h3 id="type-v2_orswot">v2_orswot() = {<a href="riak_dt_vclock.html#type-vclock" class="seealso">riak_dt_vclock:vclock()</a>, <a href="#type-entries" class="seealso">entries()</a>, <a href="#type-deferred" class="seealso">deferred()</a>}</h3></div>
    <div class="type"><h3 id="type-v2ord_orswot">v2ord_orswot() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="riak_dt_vclock.html#type-vclock" class="seealso">riak_dt_vclock:vclock()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="orddict.html#type-orddict" class="seealso">orddict:orddict()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="orddict.html#type-orddict" class="seealso">orddict:orddict()</a>}</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="new/0">new() -&gt; orswot()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="parent_clock/1">parent_clock(Clock::vclock() (see module riak_dt_vclock), Set::orswot()) -&gt; orswot()</h3>


<div class="description">

<p>sets the clock in the Set to that <code>Clock</code>. Used by a
  containing Map for sub-CRDTs</p>
</div></div>
<div class="function">
<h3 id="value/1">value(X1::orswot()) -&gt; [member()]</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="value/1-1">value(X1::orswot_q(), ORset::orswot()) -&gt; term()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="update/1">update(Op::orswot_op(), Actor::actor() | dot(), V1Set::orswot()) -&gt; {ok, orswot()} | precondition_error()</h3>


<div class="description">

<p>take a list of Set operations and apply them to the set.
  NOTE: either _all_ are applied, or _none_ are.</p>
</div></div>
<div class="function">
<h3 id="update/1-1">update(Op::orswot_op(), Actor::actor() | dot(), V1Set::orswot(), Ctx::context() (see module riak_dt)) -&gt; {ok, orswot()} | precondition_error()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="merge/1">merge(LHS::orswot(), RHS::orswot()) -&gt; orswot()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="equal/1">equal(LHS::orswot(), RHS::orswot()) -&gt; boolean()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="precondition_context/1">precondition_context(X1::orswot()) -&gt; orswot()</h3>


<div class="description">

<p>the precondition context is a fragment of the CRDT that
   operations requiring certain pre-conditions can be applied with.
   Especially useful for hybrid op/state systems where the context of
   an operation is needed at a replica without sending the entire
   state to the client. In the case of the ORSWOT the context is a
   version vector. When passed as an argument to <code>update/4</code> the
   context ensures that only seen adds are removed, and that removes
   of unseen adds can be deferred until they're seen.</p>
</div></div>
<div class="function">
<h3 id="stats/1">stats(ORSWOT::orswot()) -&gt; [{atom(), number()}]</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="stat/1">stat(Stat::atom(), S::orswot()) -&gt; number() | undefined</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="to_binary/1">to_binary(S::orswot()) -&gt; binary_orswot()</h3>


<div class="description">

<p>returns a binary representation of the provided
  <code>orswot()</code>. The resulting binary is tagged and versioned for ease
  of future upgrade. Calling <code>from_binary/1</code> with the result of this
  function will return the original set. Use the application env var
  <code>binary_compression</code> to turn t2b compression on (<code>true</code>) and off
  (<code>false</code>)
 </p>
<p><em>See also:</em> <a href="#from_binary/1" class="seealso">from_binary/1</a>.</p>
</div></div>
<div class="function">
<h3 id="to_version/1">to_version(X1::pos_integer(), Set::any_orswot()) -&gt; any_orswot()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="from_binary/1">from_binary(B::binary_orswot()) -&gt; {ok, orswot()} | {error, unsupported_version, Vers::pos_integer()} | {error, invalid_binary}</h3>


<div class="description">

<p>When the argument is a <code>binary_orswot()</code> produced by
  <code>to_binary/1</code> will return the original <code>orswot()</code>.
 </p>
<p><em>See also:</em> <a href="#to_binary/1" class="seealso">to_binary/1</a>.</p>
</div></div></div>
<div class="section"><h4>See also</h4><p><a href="riak_dt_multi.html" class="seealso">riak_dt_multi</a>, <a href="riak_dt_vclock.html" class="seealso">riak_dt_vclock</a></p></div>
<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
