<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>script_worker (wiki_creole) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>script_worker</h1>
<h2 class="modsummary">Worker server for script_manager system.</h2>
<div class="description">
<p>Worker server for <a href="script_manager.html" class="seealso">script_manager</a> system.</p>
 
   <p><code>script_worker</code> is a generic port-handler for communicating with   
os-processes that 1) can be given a batch of data to process over   
stdin, and 2) respond with their results as lines printed to   
stdout.</p>
 
   <p>To implement your script interface, write a module with the   
following four functions:</p>
 
   <p><code>init_trigger/0</code> - should return <code>none</code> if your script is ready
                      to receive data as soon as it is started, or
                      <code>process_output</code> if your script emits some                      
data before it is ready</p>
 
   <p><code>handle_init/1</code> - only needs to be implemented if <code>init_trigger/0</code>
                     returned <code>process_output</code>, and should return
                     <code>done</code> with the script is finally ready to
                     receive a request, or <code>continue</code> if the script
                     is still initing.  The parameter to <code>handle_init</code>                     
is the last line of output read from the script</p>
 
   <p><code>process/2</code> - will be called when the script manager chooses this
                 worker to process data.  The first parameter is the
                 port() that the script is connected to.  The
                 second argument is the argument that was given to
                 <a href="script_manager.html#process/2" class="seealso">script_manager:process/2</a>.  <code>process/2</code> use
                 <a href="erlang.html#port_command/2" class="seealso">erlang:port_command/2</a> to send the request
                 to the script.  The return value of <code>process/2</code>
                 is considered opaque, and will be passed verbatim
                 to <code>handle_data/2</code>.</p>
 
   <p><code>handle_data/2</code> - will be called whenever the script prints a line
                     to stdout.  The first parameter is the current
                     opaque data for the request, and the second
                     parameter is the line read from the port.
                     'handle_data/2' should return <code>{done, Response}</code>
                     if the request has completed - <code>Response</code> will
                     be returned to the caller of
                     <a href="script_manager.html#process/2" class="seealso">script_manager:process/2</a>.
                     <code>handle_data/2</code> should return
                     <code>{continue, NewOpaque}</code> if the request is still
                     processing - <code>NewOpaque</code> will be handed back
                     to <code>handle_data/2</code> with the next line read.</p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="behaviour_info/1">behaviour_info(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="start_link/3">start_link(Manager, Module, ScriptPath) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="stop/1">stop(Worker::pid()) -&gt; ok</h3>


<div class="description">

<p>Ask the worker to stop.  The worker should continue processing
       the request it was given if it has not finished it yet.</p>
</div></div>
<div class="function">
<h3 id="process/3">process(Worker, Data, From) -&gt; term()
</h3>


<div class="description">

<p>submit Data to Worker for processing, and request that the
       response be sent to From.  From should be the "From" handed
       to <a href="script_manager.html#handle_call/3" class="seealso">script_manager:handle_call/3</a></p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(Request, From, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_cast/2">handle_cast(X1, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(X1, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="terminate/2">terminate(Reason, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="code_change/3">code_change(OldVsn, State, Extra) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
