<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>riak_kv_index_hashtree (riak_kv) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>riak_kv_index_hashtree</h1>
<h2 class="modsummary">
  This module implements a gen_server process that manages a set of hashtrees
  (see hashtree) containing key/hash pairs for all data owned by a
  given partition.</h2>
<div class="description">
<p>
  This module implements a gen_server process that manages a set of hashtrees
  (see <a href="hashtree.html" class="seealso">hashtree</a>) containing key/hash pairs for all data owned by a
  given partition. Each riak_kv vnode spawns its own index_hashtree. These
  hashtrees are used for active anti-entropy exchange between vnodes.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-hashtree">hashtree() = <a href="hashtree.html#type-hashtree" class="seealso">hashtree:hashtree()</a></h3></div>
    <div class="type"><h3 id="type-index">index() = integer() &gt;= 0</h3></div>
    <div class="type"><h3 id="type-index_n">index_n() = {<a href="#type-index" class="seealso">index()</a>, integer() >= 0}</h3></div>
    <div class="type"><h3 id="type-orddict">orddict() = <a href="orddict.html#type-orddict" class="seealso">orddict:orddict()</a></h3></div>
    <div class="type"><h3 id="type-proplist">proplist() = <a href="proplists.html#type-proplist" class="seealso">proplists:proplist()</a></h3></div>
    <div class="type"><h3 id="type-riak_object_t2b">riak_object_t2b() = binary()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start/1">start(Index::index(), VNPid::pid(), Opts::proplist()) -&gt; {ok, pid()} | {error, term()}</h3>


<div class="description">

<p>Spawn an index_hashtree process that manages the hashtrees (one
       for each <code>index_n</code>) for the specified partition index.</p>
</div></div>
<div class="function">
<h3 id="start_link/1">start_link(Index::index(), VNPid::pid(), Opts::proplist()) -&gt; {ok, pid()} | {error, term()}</h3>


<div class="description">

<p>Spawn an index_hashtree process that manages the hashtrees (one
       for each <code>index_n</code>) for the specified partition index.</p>
</div></div>
<div class="function">
<h3 id="insert/3">insert(Items, Opts, Tree) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="async_insert/3">async_insert(Items, Opts, Tree) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="delete/1">delete(Items::[{binary(), binary()}], Tree::pid()) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="async_delete/1">async_delete(Items::{binary(), binary()} | [{binary(), binary()}], Tree::pid()) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="start_exchange_remote/1">start_exchange_remote(FsmPid::pid(), From::term(), IndexN::index_n(), Tree::pid()) -&gt; ok</h3>


<div class="description">

<p>Called by the entropy manager to finish the process used to acquire
       remote vnode locks when starting an exchange. For more details,
       see <url href="/home/pete/wefwefwef/docs/other/1599039297/repo/2.0.0rc2/.xml/riak_kv/./riak_kv_entropy_manager.xml#start_exchange_remote-3">riak_kv_entropy_manager:start_exchange_remote/3</url></p>
</div></div>
<div class="function">
<h3 id="update/1">update(Id::index_n(), Tree::pid()) -&gt; ok | not_responsible</h3>


<div class="description">

<p>Update all hashtrees managed by the provided index_hashtree pid.</p>
</div></div>
<div class="function">
<h3 id="exchange_bucket/1">exchange_bucket(Id::index_n(), Level::integer(), Bucket::integer(), Tree::pid()) -&gt; orddict()</h3>


<div class="description">

<p>Return a hash bucket from the tree identified by the given tree id
       that is managed by the provided index_hashtree.</p>
</div></div>
<div class="function">
<h3 id="exchange_segment/1">exchange_segment(Id::index_n(), Segment::integer(), Tree::pid()) -&gt; orddict()</h3>


<div class="description">

<p>Return a segment from the tree identified by the given tree id that
       is managed by the provided index_hashtree.</p>
</div></div>
<div class="function">
<h3 id="compare/1">compare(Id::index_n(), Remote::remote_fun() (see module hashtree), Tree::pid()) -&gt; [keydiff() (see module hashtree)]</h3>


<div class="description">

<p>Start the key exchange between a given tree managed by the
       provided index_hashtree and a remote tree accessed through the
       provided remote function.</p>
</div></div>
<div class="function">
<h3 id="compare/1-1">compare(Id::index_n(), Remote::remote_fun() (see module hashtree), AccFun::undefined | acc_fun(T) (see module hashtree), Tree::pid()) -&gt; T</h3>


<div class="description">

<p>A variant of <a href="#compare/3" class="seealso">compare/3</a> that takes a key difference accumulator
       function as an additional parameter.</p>
</div></div>
<div class="function">
<h3 id="compare/1-2">compare(Id::index_n(), Remote::remote_fun() (see module hashtree), AccFun::undefined | acc_fun(T) (see module hashtree), Acc::any(), Tree::pid()) -&gt; T</h3>


<div class="description">

<p>A variant of <a href="#compare/3" class="seealso">compare/3</a> that takes a key difference accumulator
       function as an additional parameter.</p>
</div></div>
<div class="function">
<h3 id="get_lock/1">get_lock(Tree::pid(), Type::any()) -&gt; ok | not_built | already_locked</h3>


<div class="description">

<p>Acquire the lock for the specified index_hashtree if not already
       locked, and associate the lock with the calling process.</p>
</div></div>
<div class="function">
<h3 id="poke/1">poke(Tree::pid()) -&gt; ok</h3>


<div class="description">

<p>Poke the specified index_hashtree to ensure the tree is
       built/rebuilt as needed. This is periodically called by the
       <url href="/home/pete/wefwefwef/docs/other/1599039297/repo/2.0.0rc2/.xml/riak_kv/./riak_kv_entropy_manager.xml">riak_kv_entropy_manager</url>.</p>
</div></div>
<div class="function">
<h3 id="stop/1">stop(Tree) -&gt; term()
</h3>


<div class="description">

<p>Terminate the specified index_hashtree.</p>
</div></div>
<div class="function">
<h3 id="destroy/1">destroy(Tree::pid()) -&gt; ok</h3>


<div class="description">

<p>Destroy the specified index_hashtree, which will destroy all
       associated hashtrees and terminate.</p>
</div></div>
<div class="function">
<h3 id="clear/1">clear(Tree) -&gt; term()
</h3>


<div class="description">

<p>Clear the specified index_hashtree, clearing all associated hashtrees</p>
</div></div>
<div class="function">
<h3 id="expire/1">expire(Tree) -&gt; term()
</h3>


<div class="description">

<p>Expire the specified index_hashtree</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(Request, From, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_cast/2">handle_cast(Msg, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(Info, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="terminate/2">terminate(Reason, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="code_change/3">code_change(OldVsn, State, Extra) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="determine_data_root/0">determine_data_root() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="hash_object/1">hash_object(X1::{bucket() (see module riak_object), key() (see module riak_object)}, RObj0::riak_object_t2b() | riak_object() (see module riak_object)) -&gt; binary()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="hash_index_data/1">hash_index_data(IndexData) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="index_2i_n/0">index_2i_n() -&gt; {0, 0}</h3>


<div class="description">

<p>the 2i index hashtree as a Magic index_n of {0, 0}</p>
</div></div>
<div class="function">
<h3 id="get_build_time/1">get_build_time(Tree::hashtree()) -&gt; t_now() (see module calendar)</h3>


<div class="description">
 </div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
