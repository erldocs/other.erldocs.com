<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>jiak_example (riak) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>jiak_example</h1>
<h2 class="modsummary">jiak_example is a demonstration of the sort of module that       
jiak_resource needs for storing objects in a bucket.</h2>
<div class="description">
<p>jiak_example is a demonstration of the sort of module that       
jiak_resource needs for storing objects in a bucket.</p>
 
       <p>jiak_example controls the jiak_example Riak bucket.  In       
general, jiak_resource expects the name of the Riak bucket       
and the name of the controlling module to match.</p>
 
       <p>Objects in the jiak_example bucket must have at least a field
       named "foo", foo are allowed to also have fields named "bar",
       "baz", and "quux".  Clients can only read "foo" and "bar", and
       can only write "foo" and "baz".  Or, a little more graphically:
 </p><pre class="sh_erlang">
              READ   WRITE
       "foo":  X       X
       "bar":  X
       "baz":          X
      "quux":
 </pre></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="init/1">init(Key::key() (see module jiak_resource), Context::jiak_context()) -&gt; {ok, jiak_context()}</h3>


<div class="description">

<p>initialize Context for use in this module</p>
</div></div>
<div class="function">
<h3 id="auth_ok/1">auth_ok(Key::key() (see module jiak_resource), ReqData::wrq() (see module webmachine), Context::jiak_context()) -&gt; {true | auth_header() (see module webmachine), wrq() (see module webmachine), jiak_context()}</h3>


<div class="description">

<p>This function should behave exactly as the is_authorized/2
       function of any Webmachine resource would behave.</p>
</div></div>
<div class="function">
<h3 id="bucket_listable/0">bucket_listable() -&gt; boolean()</h3>


<div class="description">

<p>Return 'true' if you want clients to be able to request the
       list of keys in this bucket through jiak_resource.  Return
       'false' if the keylist should not be client-visible.</p>
</div></div>
<div class="function">
<h3 id="allowed_fields/0">allowed_fields() -&gt; [binary()]</h3>


<div class="description">

<p>Return a list of field names that are allowed to exist
       in objects of this type.</p>
</div></div>
<div class="function">
<h3 id="required_fields/0">required_fields() -&gt; [binary()]</h3>


<div class="description">

<p>Return a list of field names that must exist in a valid
       object of this type</p>
</div></div>
<div class="function">
<h3 id="read_mask/0">read_mask() -&gt; [binary()]</h3>


<div class="description">

<p>Return a list of fields that a client using jiak_resource
       should see.  Fields not in this list will be removed from
       the object before sending it to the client.</p>
</div></div>
<div class="function">
<h3 id="write_mask/0">write_mask() -&gt; [binary()]</h3>


<div class="description">

<p>Return a list of fields that a client may change through
       jiak_resource.  Edits made by a client to fields that are
       not in this list will generate an error.</p>
</div></div>
<div class="function">
<h3 id="expires_in_seconds/1">expires_in_seconds(Key::key() (see module jiak_resource), ReqData::wrq() (see module webmachine), Context::jiak_context()) -&gt; {integer(), wrq() (see module webmachine), jiak_context()}</h3>


<div class="description">

<p>Return the number of seconds a client should be allowed to
       cache an object of this type.  This is very similar to the
       expires/2 function of a Webmachine resource, except that it
       returns a number of seconds instead of a datetime.</p>
</div></div>
<div class="function">
<h3 id="check_write/2">check_write(X1::{container | item, key() (see module riak_object)}, JiakObject::jiak_object(), ReqData::wrq() (see module webmachine), Context::jiak_context()) -&gt; {{ok, jiak_object()} | {error, term()}, wrq() (see module webmachine), jiak_context()}</h3>


<div class="description">

<p>Decide whether or not a write should be allowed.  This
       function should check the validity of JiakObject and/or the
       set of diffs in Context, then return a tuple including {ok, J}
       if the write should be allowed or {error, Reason} if it should
       not be.  The returned JiakObject may be the same JiakObject
       passed in, or a modified one.</p>
</div></div>
<div class="function">
<h3 id="effect_write/1">effect_write(Key::key() (see module jiak_resource), JiakObject::jiak_object(), ReqData::wrq() (see module webmachine), Context::jiak_context()) -&gt; {{ok, jiak_object()} | {error, term()}, wrq() (see module webmachine), jiak_context()}</h3>


<div class="description">

<p>It has been determined that JiakObject is valid, and it will
       be written - this function is an opportunity to act on that
       information before the write happens.  The object returned
       from this function will be the one stored into Riak (plus
       the chosen key if this is a new object POSTed to the bucket).</p>
</div></div>
<div class="function">
<h3 id="after_write/1">after_write(Key::key() (see module jiak_resource), JiakObject::jiak_object(), ReqData::wrq() (see module webmachine), Context::jiak_context()) -&gt; {ok, wrq() (see module webmachine), jiak_context()}</h3>


<div class="description">

<p>JiakObject has been stored in riak - this function is an
       opportunity to act on that information.</p>
</div></div>
<div class="function">
<h3 id="merge_siblings/1">merge_siblings(Siblings::[{Metadata::dict(), {Object::struct() (see module mochijson2), Links::[link() (see module jiak_object)]}}]) -&gt; {dict(), {struct() (see module mochijson2), [link() (see module jiak_object)]}}</h3>


<div class="description">

<p>Merge Riak-sibling jiak objects.  Siblings are passed in
       in the form {RiakObjectMetadata,{JiakObjectData,JiakLinks}},
       and this functino should return exactly one structure of
       the same shape.</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
