<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>parse_trans (parse_trans) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>parse_trans</h1>
<h2 class="modsummary">Generic parse transform library for Erlang.</h2>
<div class="description">
<p>Generic parse transform library for Erlang.</p>
  
   <p>...</p>
  </div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-form">form() = any()</h3></div>
    <div class="type"><h3 id="type-forms">forms() = [<a href="#type-form" class="seealso">form()</a>]</h3></div>
    <div class="type"><h3 id="type-insp_f">insp_f() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun((<a href="#type-type" class="seealso">type()</a>, <a href="#type-form" class="seealso">form()</a>, #context{}, A) -> {boolean(), A})</h3></div>
    <div class="type"><h3 id="type-options">options() = [{atom(), any()}]</h3></div>
    <div class="type"><h3 id="type-type">type() = atom()</h3></div>
    <div class="type"><h3 id="type-xform_f_df">xform_f_df() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun((<a href="#type-type" class="seealso">type()</a>, <a href="#type-form" class="seealso">form()</a>, #context{}, Acc) -><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="#type-form" class="seealso">form()</a>, Acc} | {<a href="#type-forms" class="seealso">forms()</a>, <a href="#type-form" class="seealso">form()</a>, <a href="#type-forms" class="seealso">forms()</a>, Acc})</h3></div>
    <div class="type"><h3 id="type-xform_f_rec">xform_f_rec() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fun((<a href="#type-type" class="seealso">type()</a>, <a href="#type-form" class="seealso">form()</a>, #context{}, Acc) -><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="#type-form" class="seealso">form()</a>, boolean(), Acc} |<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="#type-forms" class="seealso">forms()</a>, <a href="#type-form" class="seealso">form()</a>, <a href="#type-forms" class="seealso">forms()</a>, boolean(), Acc})</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="error/3">error(R::Reason, F::Form, I::Info) -&gt; throw()</h3>

<ul class="type">
<li><code>Info = [{Key, Value}]</code></li></ul>
<div class="description">

<p>Used to report errors detected during the parse transform.</p>
</div></div>
<div class="function">
<h3 id="plain_transform/2">plain_transform(Fun, Forms) -&gt; forms()</h3>

<ul class="type">
<li><code>Fun = function()</code></li><li><code>Forms = forms()</code></li></ul>
<div class="description">

<p>
  Performs a transform of <code>Forms</code> using the fun <code>Fun(Form)</code>. <code>Form</code> is always
  an Erlang abstract form, i.e. it is not converted to syntax_tools
  representation. The intention of this transform is for the fun to have a
  catch-all clause returning <code>continue</code>. This will ensure that it stays robust  
against additions to the language.</p>
 
  <p><code>Fun(Form)</code> must return either of the following:</p>
 
  <p>* <code>NewForm</code> - any valid form
  * <code>continue</code> - dig into the sub-expressions of the form
  * <code>{done, NewForm}</code> - Replace <code>Form</code> with <code>NewForm</code>; return all following
    forms unchanged
  * <code>{error, Reason}</code> - Abort transformation with an error message.</p>
 
  <p>Example - This transform fun would convert all instances of <code>P ! Msg</code> to
  <code>gproc:send(P, Msg)</code>:
  </p><pre class="sh_erlang">
  parse_transform(Forms, _Options) -&gt;
      parse_trans:plain_transform(fun do_transform/1, Forms).
 
  do_transform({'op', L, '!', Lhs, Rhs}) -&gt;
       [NewLhs] = parse_trans:plain_transform(fun do_transform/1, [Lhs]),
       [NewRhs] = parse_trans:plain_transform(fun do_transform/1, [Rhs]),
      {call, L, {remote, L, {atom, L, gproc}, {atom, L, send}},
       [NewLhs, NewRhs]};
  do_transform(_) -&gt;
      continue.
  </pre>
</div></div>
<div class="function">
<h3 id="get_pos/1">get_pos(I::list()) -&gt; integer()</h3>


<div class="description">

<p>
  Tries to retrieve the line number from an erl_syntax form. Returns a
  (very high) dummy number if not successful.</p>
</div></div>
<div class="function">
<h3 id="get_file/1">get_file(Forms) -&gt; string()</h3>


<div class="description">

<p>
   Returns the name of the file being compiled.</p>
</div></div>
<div class="function">
<h3 id="get_module/1">get_module(Forms) -&gt; atom()</h3>


<div class="description">

<p>
   Returns the name of the module being compiled.</p>
</div></div>
<div class="function">
<h3 id="get_attribute/2">get_attribute(A, Forms) -&gt; any()</h3>

<ul class="type">
<li><code>A = atom()</code></li></ul>
<div class="description">

<p>
   Returns the value of the first occurence of attribute A.</p>
</div></div>
<div class="function">
<h3 id="function_exists/1">function_exists(Fname::atom(), Arity::integer(), Forms) -&gt; boolean()</h3>


<div class="description">

<p>
  Checks whether the given function is defined in Forms.</p>
</div></div>
<div class="function">
<h3 id="initial_context/2">initial_context(Forms, Options) -&gt; #context{}</h3>


<div class="description">

<p>
   Initializes a context record. When traversing through the form
   list, the context is updated to reflect the current function and
   arity. Static elements in the context are the file name, the module
   name and the options passed to the transform function.</p>
</div></div>
<div class="function">
<h3 id="transform/4">transform(Fun, Acc, Forms, Options) -&gt; {TransformedForms, NewAcc}</h3>

<ul class="type">
<li><code>Fun = function()</code></li><li><code>Options = [{Key, Value}]</code></li></ul>
<div class="description">

<p>
   Makes one pass</p>
</div></div>
<div class="function">
<h3 id="depth_first/1">depth_first(Fun::xform_f_df(), Acc, Forms::forms(), Options::options()) -&gt; {forms(), Acc} | {error, list()}</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="top/1">top(F::function(), Forms::forms(), Options::list()) -&gt; forms() | {error, term()}</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="replace_function/4">replace_function(F, Arity, NewForm, Forms) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="export_function/3">export_function(F, Arity, Forms) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="do_insert_forms/2">do_insert_forms(X1::above | below, Insert::forms(), Forms::forms(), Context::#context{}) -&gt; forms()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="optionally_pretty_print/1">optionally_pretty_print(Result::forms(), Options::options(), Context::#context{}) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="inspect/4">inspect(F::Fun, Acc::Forms, Forms::Acc, Options) -&gt; NewAcc</h3>

<ul class="type">
<li><code>Fun = function()</code></li></ul>
<div class="description">

<p>
   Equvalent to do_inspect(Fun,Acc,Forms,initial_context(Forms,Options)).</p>
</div></div>
<div class="function">
<h3 id="pp_src/2">pp_src(Res::Forms, Out::filename()) -&gt; ok</h3>


<div class="description">

<p>Pretty-prints the erlang source code corresponding to Forms into Out
 </p>
</div></div>
<div class="function">
<h3 id="pp_beam/1">pp_beam(Beam::filename() (see module file)) -&gt; string() | {error, Reason}</h3>


<div class="description">

<p>
  Reads debug_info from the beam file Beam and returns a string containing
  the pretty-printed corresponding erlang source code.</p>
</div></div>
<div class="function">
<h3 id="pp_beam/1-1">pp_beam(Beam::filename(), Out::filename()) -&gt; ok | {error, Reason}</h3>


<div class="description">

<p>
  Reads debug_info from the beam file Beam and pretty-prints it as
  Erlang source code, storing it in the file Out.</p>
</div></div>
<div class="function">
<h3 id="get_orig_syntax_tree/1">get_orig_syntax_tree(File) -&gt; Forms</h3>


<div class="description">

<p>Fetches a Syntax Tree representing the code before pre-processing,
   that is, including record and macro definitions. Note that macro
   definitions must be syntactically complete forms (this function
   uses epp_dodger).</p>
</div></div>
<div class="function">
<h3 id="revert/1">revert(Tree) -&gt; Forms</h3>


<div class="description">

<p>Reverts back from Syntax Tools format to Erlang forms.
   </p><p>Note that the Erlang forms are a subset of the Syntax Tools
   syntax tree, so this function is safe to call even on a list of
   regular Erlang forms.</p>
</div></div>
<div class="function">
<h3 id="context/2">context(X1::Attr, Context) -&gt; any()</h3>

<ul class="type">
<li><code>Attr = module | function | arity | options</code></li></ul>
<div class="description">

<p>
   Accessor function for the Context record.</p>
</div></div>
<div class="function">
<h3 id="do_inspect/1">do_inspect(F::insp_f(), Acc::term(), Forms::forms(), Context::#context{}) -&gt; term()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="do_transform/1">do_transform(F::xform_f_rec(), Acc::term(), Forms::forms(), Context::#context{}) -&gt; {forms(), term()}</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="do_depth_first/1">do_depth_first(F::xform_f_df(), Acc::term(), Forms::forms(), Context::#context{}) -&gt; {forms(), term()}</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="format_error/1">format_error(Error::{atom(), term()}) -&gt; iolist()</h3>


<div class="description">
 </div></div></div>

<authors>

<aname>: Ulf Wiger</aname>
<email>ulf.wiger@feuerlabs.com</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
