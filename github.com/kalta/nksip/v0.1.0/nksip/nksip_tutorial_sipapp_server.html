<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>nksip_tutorial_sipapp_server (nksip) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>nksip_tutorial_sipapp_server</h1>
<h2 class="modsummary">SipApp Tutorial server callback module implementation.</h2>
<div class="description">
<p>SipApp Tutorial server callback module implementation.</p>
 
  <p>This modules implements a proxy server callback module for NkSIP Tutorial.
  It allows any request from any user in domain "nksip", having password "1234".
  Requests without user and domain "nksip" are processed internally (i.e. "sip:nksip").
  Request with user and domain "nksip" are found (as a registrar) and proxied.
  Other requests are proxied to the same origin Request-URI</p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">

<p>SipApp intialization.</p>
</div></div>
<div class="function">
<h3 id="get_user_pass/4">get_user_pass(User, Realm, From, State) -&gt; term()
</h3>


<div class="description">

<p>Called to check user's password.</p>
 
  <p>If the incoming user's realm is "nksip", the password for any user is "1234".
  For other realms, no password is valid.</p>
</div></div>
<div class="function">
<h3 id="authorize/4">authorize(Auth, ReqId, From, State) -&gt; term()
</h3>


<div class="description">

<p>Called to check if a request should be authorized.</p>
 
  <p>1) We first check to see if the request is an in-dialog request, coming from     
the same ip and port of a previously authorized request.</p>
 
  <p>2) If not, we check if we have a previous authorized REGISTER request from     
the same ip and port.</p>
 
  <p>3) Next, we check if the request has a valid authentication header with realm
     "nksip". If <code>{{digest, &lt;&lt;"nksip"&gt;&gt;}, true}</code> is present, the user has
     provided a valid password and it is authorized.
     If <code>{{digest, &lt;&lt;"nksip"&gt;&gt;}, false}</code> is present, we have presented     
a challenge, but the user has failed it. We send 403.</p>
 
  <p>4) If no digest header is present, reply with a 407 response sending
     a challenge to the user.</p>
</div></div>
<div class="function">
<h3 id="route/6">route(Scheme, User, Domain, ReqId, From, State) -&gt; term()
</h3>


<div class="description">

<p>Called to decide how to route every new request.</p>
 
  <p>- If the Request-Uri has no user part, and domain is "nksip", process the request    
internally. If domain is not "nksip", and the destination is    
not local (for example because of a Route header), proxy the request.</p>
 
  <p>- If it has user part, and domain is "nksip", find if it is registered and proxy.
    For other domain, proxy the request.</p>
</div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(X1, From, State) -&gt; term()
</h3>


<div class="description">

<p>Synchronous user call.</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
