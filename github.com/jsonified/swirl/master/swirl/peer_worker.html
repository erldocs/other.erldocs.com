<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>peer_worker (swirl) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>peer_worker</h1>
<h2 class="modsummary">A managed PPSPP UDP-based Peer.</h2>
<div class="description">
<p>A managed PPSPP UDP-based Peer.</p>
 
  <p>The peer_worker provides a wrapper around the standard <code>gen_udp</code> server
  spawning an additional erlang process for every received datagram.
  At startup, the <code>peer_worker</code> registers itself in the <code>gproc</code> registry  
with the assigned UDP port.</p>
 
  <p>Note that every port has a 1-to-1 association to a specific swarm,
  comprising options, IP, and port. The main reason for this is
  to be able to pass these swarm options through to the packet decoder
  when checking that the requested hash is available in this swarm or not,
  without requiring additional lookups.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-state">state() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#state{options = undefined | <a href="ppspp_options.html#type-options" class="seealso">ppspp_options:options()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port = undefined | <a href="inet.html#type-port_number" class="seealso">inet:port_number()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket = undefined | port()}</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_link/1">start_link(Port::port_number() (see module inet), Swarm_Options::options() (see module ppspp_options)) -&gt; ignore | {error, term()} | {ok, pid()}</h3>


<div class="description">

<p>Start the peer with given port number and ppspp options which
  includes the root hash and chunk addressing specification. These are
  required during subsequent packet parsing, even if the peer itself
  supports multiple swarms.</p>
</div></div>
<div class="function">
<h3 id="stop/1">stop(Port::port_number() (see module inet)) -&gt; ok | {error, any()}</h3>


<div class="description">

<p>Stops the server, given a corresponding UDP port.
  Returns an error tuple if the port is no longer active.</p>
</div></div>
<div class="function">
<h3 id="where_is/1">where_is(Port::port_number() (see module inet)) -&gt; {ok, pid()} | {error, term()}</h3>


<div class="description">

<p>Looks up the pid for a given port
  Returns an error tuple if the port cannot be found in the registry.</p>
</div></div>
<div class="function">
<h3 id="pid_to_port/1">pid_to_port(Pid::pid()) -&gt; {ok, port_number() (see module inet)} | {error, term()}</h3>


<div class="description">

<p>Looks up the port for a given pid.
  Returns an error tuple if the port cannot be found in the registry.</p>
</div></div>
<div class="function">
<h3 id="get_url/1">get_url(Port::port_number() (see module inet)) -&gt; {ok, string()}</h3>


<div class="description">

<p>Create a URL for this endpoint that another peer could connect to.
  As there is no official spec for URLs yet, I made one up. See <code>url.md</code>.
  A simple example is ppspp://example.net:7777/c89800bf</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1::[port_number() (see module inet) | options() (see module ppspp_options)]) -&gt; {ok, [state()]}</h3>


<div class="description">

<p>Initialises the <code>peer_worker</code> and associated UDP port.
  Registers the worker with provided swarm options and UDP port in <code>gproc</code>.</p>
</div></div>
<div class="function">
<h3 id="handle_cast/1">handle_cast(Message::stop | any(), State::[state()]) -&gt; {noreply, state()}</h3>


<div class="description">

<p>Default <code>gen_server</code> API.</p>
</div></div>
<div class="function">
<h3 id="handle_call/1">handle_call(Message::any(), From::{pid(), any()}, State::[state()]) -&gt; {reply, ok, state()}</h3>


<div class="description">

<p>Default <code>gen_server</code> API.</p>
</div></div>
<div class="function">
<h3 id="handle_info/1">handle_info(Packet::term(), State::[state()]) -&gt; {noreply, [state()]} | {stop, {error, {unknown_info, term()}}, term()}</h3>


<div class="description">

<p>Receives UDP datagrams from <code>gen_udp</code> server and spawns a subsidiary
  process to manage it. Returns <code>noreply</code> tuple.</p>
</div></div>
<div class="function">
<h3 id="code_change/1">code_change(OldVsn::term(), State::[state()], Extra::term()) -&gt; {ok, [state()]}</h3>


<div class="description">

<p>Default <code>gen_server</code> API.</p>
</div></div>
<div class="function">
<h3 id="terminate/1">terminate(Reason::term(), X2::[state()]) -&gt; ok</h3>


<div class="description">

<p>Closes down the <code>peer_worker</code>. Returns reason and brief statistics.</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
