<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>chef_keygen_cache (chef_authn) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>chef_keygen_cache</h1>
<h2 class="modsummary">chef_keygen_cache Precreates RSA key pairs and servers them when you ask.</h2>
<div class="description">
<p>chef_keygen_cache Precreates RSA key pairs and servers them when you ask.</p>
 
  <p>chef_keygen_cache is a gen_server that keeps a configurable number of RSA key pairs on
  hand for fast delivery. There is a throttled mechanism (to avoid hogging CPU) to
  replinish the key cache when it drops below the desired size. Keys are created on demand
  if the cache is empty. If inline key generation exceeds a configured timeout, the atom
  <code>timeout</code> is returned. Inline key generation happens in the calling process and does not  
block the server.</p>
 
  <p>You can control the behavior of the key cache using the following app config keys:
  </p><list>
  <item><p>keygen_size: Size in bits of the RSA keys to generate. Defaults to 2048. Mostly used
  to speed up testing.</p></item>
  <item><p>keygen_cache_size: The number of keys to store in the cache</p></item>
  <item><p>keygen_timeout: Time allowed for the external key generation command (openssl). A
  timeout atom is returned if the command takes longer than <code>Timeout</code> milliseconds. </p></item>
  <item><p>keygen_cache_workers: The number of workers available to generate key pairs. This
  should never be larger than the number of logical CPUs. Defaults to larger of 1 and half
  the number of logical processors as reported by <code>erlang:system_info(logical_processors)</code>
  </p></item>
  <item><p>keygen_cache_pause: Time in milliseconds to use as throttle on key
  generation. Workers will not be spawned more frequently than every <code>Pause</code>
  milliseconds. If <code>Pause</code> is 0, there is no throttling. Since the cache will need to
  refill on service restart, this is useful to tradeoff speed of cache fill for available
  CPU to handle requests.</p></item>
  </list></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_link/0">start_link() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="stop/0">stop() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_key_pair/0">get_key_pair() -&gt; {PublicKey::binary(), PrivateKey::binary()} | keygen_timeout</h3>


<div class="description">

<p>Retrieve an RSA key pair from the cache.</p>
 
  <p>The return value is a tuple of the form <code>{PublicKey, PrivateKey}</code> where each element is a
  binary containing the PEM encoded key. If no keys are available in the cache, a key will
  be generated inline with this call. If key generation exceeds the timeout value specified
  in app config <code>{chef_authn, kegen_timeout, Timeout}</code>, then the atom <code>timeout</code> is
  returned. Note that inline key generation, if needed, occurs in the process calling this
  function, not in the server.
 </p>
</div></div>
<div class="function">
<h3 id="status/0">status() -&gt; [{atom(), term()}]</h3>


<div class="description">

<p>Return a proplist of status information about the state of the key cache.</p>
</div></div>
<div class="function">
<h3 id="update_config/0">update_config() -&gt; ok</h3>


<div class="description">

<p>Instruct the cache to reread app config values. This can be used if you want to
  modify the cache size or cache pause values in a running cache.</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(Request, From, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_cast/2">handle_cast(Request, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(Key_pair, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="terminate/2">terminate(Reason, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="code_change/3">code_change(OldVsn, State, Extra) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
