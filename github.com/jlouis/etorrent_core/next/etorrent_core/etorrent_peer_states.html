<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>etorrent_peer_states (etorrent_core) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>etorrent_peer_states</h1>
<h2 class="modsummary">Track the states of peers.</h2>
<div class="description">
<p>Track the states of peers.
  </p><p>This module implements a bookkeeping server. The server has
  ETS tables which is used to save the current upload and download
  rate as well as the state of each peer.</p>
  <p>Periodically, each peer stores data in these tables. Then the
  <code>choker</code> process extracts the information when it wants to
  recalculate the chokes of peers.</p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_link/0">start_link() -&gt; ignore | {ok, pid()} | {error, term()}</h3>


<div class="description">

<p>Start the server</p>
</div></div>
<div class="function">
<h3 id="all_peers/0">all_peers() -&gt; [proplist() (see module proplists)]</h3>


<div class="description">

<p>Return the states of all peers</p>
</div></div>
<div class="function">
<h3 id="set_choke/1">set_choke(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update a peer state to <code>choked</code>
  </p><p><em>Clarification:</em> This state is what the remote peer has
  done to us.</p>
</div></div>
<div class="function">
<h3 id="set_unchoke/1">set_unchoke(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update a peer state to <code>unchoked</code>
  </p><p><em>Clarification:</em> This state is what the remote peer has
  done to us.</p>
</div></div>
<div class="function">
<h3 id="set_interested/1">set_interested(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update a peer state to <code>interested</code>
  </p><p><em>Clarification:</em> This state is what the remote peer
  thinks of us.</p>
</div></div>
<div class="function">
<h3 id="set_not_interested/1">set_not_interested(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update a peer state to <code>not_interested</code>
  </p><p><em>Clarification:</em> This state is what the remote peer
  thinks of us.</p>
</div></div>
<div class="function">
<h3 id="set_local_choke/1">set_local_choke(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update state: we <code>choke</code> the peer</p>
</div></div>
<div class="function">
<h3 id="set_local_unchoke/1">set_local_unchoke(Id::integer(), Pid::pid()) -&gt; ok</h3>


<div class="description">

<p>Update state: we no longer <code>choke</code> the peer</p>
</div></div>
<div class="function">
<h3 id="get_state/1">get_state(Id::integer(), Who::pid()) -&gt; {value, boolean(), [{atom(), term()}]}</h3>


<div class="description">

<p>Get the current state of a peer
  </p><p>This function return <code>{value, Snubbed, PL}</code> where <code>Snubbed</code> is a
  boolean() telling us whether the peer has been snubbed or not. <code>PL</code>
  is a property list with these fields:
  </p><taglist>
   <dt><code>pid</code></dt>
     <item><p>The pid of the peer</p></item>
   <dt><code>choke_state</code></dt>
     <item><p>boolean() - is the remote choking us?</p></item>
   <dt><code>interest_state</code></dt>
     <item><p>Is the peer interested in us?</p></item>
   <dt><code>local_choke</code></dt>
     <item><p>Are we currently choking the peer?</p></item>
  </taglist>
</div></div>
<div class="function">
<h3 id="get_peer_state/1">get_peer_state(Id::integer(), Who::pid()) -&gt; {value, #peer_state{tid_pid=undefined | {pos_integer() | '_', pid() | '_'}, choke_state=choked | unchoked | '_', interest_state=interested | not_interested | '_', local_choke=boolean() | '_'}}</h3>


<div class="description">
<p><em>This function is deprecated: </em>I don't want to export the record</p>

<p>Get the <code>#peer_state{}</code> record for a peer.
  </p><p>If the peer is not in the table, the standard the default record
  is returned.</p>
</div></div>
<div class="function">
<h3 id="get_pids_interest/2">get_pids_interest(Id, Pid) -&gt; term()
</h3>


<div class="description">

<p>Return a property list of interest for a pid
  </p><p>The following values are returned: <code>interested</code>, <code>choking</code>. Both
  are boolean() values signifying what the remote thinks of us.</p>
  <p>If the pid is not found, a dummy value is returned. Such a
  dummy-peer is never interested and always choking.</p>
</div></div>
<div class="function">
<h3 id="get_recv_rate/1">get_recv_rate(Id::integer(), Pid::pid()) -&gt; none | undefined | float()</h3>


<div class="description">

<p>Get the receive rate of the peer</p>
</div></div>
<div class="function">
<h3 id="get_send_rate/1">get_send_rate(Id::integer(), Pid::pid()) -&gt; none | undefined | float()</h3>


<div class="description">

<p>Get the send rate of the peer</p>
</div></div>
<div class="function">
<h3 id="set_recv_rate/1">set_recv_rate(Id::integer(), Pid::pid(), Rate::float(), SnubState::normal | snubbed) -&gt; ok</h3>


<div class="description">

<p>Set the receive rate of the peer.
  Pid is a pid of the peer control process.</p>
</div></div>
<div class="function">
<h3 id="set_send_rate/1">set_send_rate(Id::integer(), Pid::pid(), Rate::float()) -&gt; ok</h3>


<div class="description">

<p>Set the send rate of the peer.
  Pid is a pid of the peer control process.</p>
</div></div>
<div class="function">
<h3 id="get_torrent_rate/1">get_torrent_rate(Id::integer(), Direction::leeching | seeding) -&gt; {ok, float()}</h3>


<div class="description">

<p>Get the rate of a given Torrent
  </p><p>This function proceeds by summing the rates for a given torrent.</p>
  <p>The <code>Direction</code> parameter is either <code>leeching</code> or <code>seeding</code>. If
  we are leeching the torrent, the receive rate is used. If we are
  seeding, the send rate is used.</p>
</div></div>
<div class="function">
<h3 id="get_global_rate/0">get_global_rate() -&gt; {float(), float()}</h3>


<div class="description">

<p>Return the global receive and send rates
  </p><p>This function returns <code>{Recv, Send}</code> where both <code>Recv</code> and
  <code>Send</code> are float() values.</p>
</div></div>
<div class="function">
<h3 id="get_peer/2">get_peer(Id, Who) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>

<aname>Jesper Louis Andersen</aname>
<email>jesper.louis.andersen@gmail.com</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
