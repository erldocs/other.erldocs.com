<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>etorrent_rqueue (etorrent) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>etorrent_rqueue</h1>
<h2 class="modsummary">Request queue for peers  
This module provides a wrapper for the queue module from stdlib, it  
assumes that responses to chunk requests are delivered in the same  
order as they were sent.</h2>
<div class="description">
<p>Request queue for peers  
This module provides a wrapper for the queue module from stdlib, it  
assumes that responses to chunk requests are delivered in the same  
order as they were sent.</p>
 
  <p>The module provides additional functions for validating incoming  
requests against the head of the queue. We want to verify that the  
piece, offset and chunk length matches. We also want to be able to  
detect if the piece and offset but not the chunk length matches.</p>
 
  <p>The module also provides additional functions for checking if the
  request pipeline needs to be refilled or not. The thresholds are
  encapsulated in the request queue.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-pieceindex">pieceindex() = <a href="etorrent_types.html#type-piece_index" class="seealso">etorrent_types:piece_index()</a></h3></div>
    <div class="type"><h3 id="type-requestspec">requestspec() = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a href="#type-pieceindex" class="seealso">pieceindex()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="etorrent_types.html#type-chunk_offset" class="seealso">etorrent_types:chunk_offset()</a>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="etorrent_types.html#type-chunk_len" class="seealso">etorrent_types:chunk_len()</a>}</h3></div>
    <div class="type"><h3 id="type-rqueue">rqueue()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="new/0">new() -&gt; rqueue()</h3>


<div class="description">

<p>Create an empty request queue with default pipeline thresholds
  Note that the outgoing and incoming request queue are subject to different
  default thresholds. We should probably remove this function to avoid any
  confusion about this being equal.</p>
</div></div>
<div class="function">
<h3 id="new/1">new(Lowthreshold::non_neg_integer(), Highthreshold::pos_integer()) -&gt; rqueue()</h3>


<div class="description">

<p>Create an empty request queue and specify pipeline thresholds</p>
</div></div>
<div class="function">
<h3 id="flush/1">flush(Requestqueue::rqueue()) -&gt; rqueue()</h3>


<div class="description">

<p>Remove all items from a request queue and return an empty queue</p>
</div></div>
<div class="function">
<h3 id="to_list/1">to_list(Requestqueue::rqueue()) -&gt; [requestspec()]</h3>


<div class="description">

<p>Get the list of chunks in the request queue</p>
</div></div>
<div class="function">
<h3 id="pieces/1">pieces(Requestqueue::rqueue()) -&gt; [pieceindex()]</h3>


<div class="description">

<p>Return a list of all unique pieces that occur in the queue</p>
</div></div>
<div class="function">
<h3 id="push/1">push(Pieceindex::pieceindex(), Offset::chunk_offset() (see module etorrent_types), Length::chunk_len() (see module etorrent_types), Requestqueue::rqueue()) -&gt; rqueue()</h3>


<div class="description">

<p>Push a request onto the end of the request queue
  The queue returns a new queue including the new request.</p>
</div></div>
<div class="function">
<h3 id="push/1-1">push(Requests::[requestspec()], Requestqueue::rqueue()) -&gt; rqueue()</h3>


<div class="description">

<p>Push a list of requests onto the end of the request queue
  The function returns a new queue including the new requests.</p>
</div></div>
<div class="function">
<h3 id="pop/1">pop(Requestqueue::rqueue()) -&gt; rqueue()</h3>


<div class="description">

<p>Return the head of the request queue and the tail of the queue
  If the request queue is empty the function will throw a badarg error.
  TODO - rename this function tail and add pop function</p>
</div></div>
<div class="function">
<h3 id="peek/1">peek(Requestqueue::rqueue()) -&gt; false | requestspec()</h3>


<div class="description">

<p>Return the head of the queue
  If the queue is empty this function will return false.</p>
</div></div>
<div class="function">
<h3 id="size/1">size(Requestqueue::rqueue()) -&gt; non_neg_integer()</h3>


<div class="description">

<p>Return the number of requests in the queue.</p>
</div></div>
<div class="function">
<h3 id="is_head/1">is_head(Pieceindex::pieceindex(), Offset::chunk_offset() (see module etorrent_types), Length::chunk_len() (see module etorrent_types), Requestqueue::rqueue()) -&gt; boolean()</h3>


<div class="description">

<p>Check if a request is at the head of the request queue</p>
</div></div>
<div class="function">
<h3 id="has_offset/1">has_offset(Pieceindex::pieceindex(), Offset::chunk_offset() (see module etorrent_types), Requestqueue::rqueue()) -&gt; boolean()</h3>


<div class="description">

<p>Check if the offset of a request matches the head of the queue</p>
</div></div>
<div class="function">
<h3 id="is_low/1">is_low(Requestqueue::rqueue()) -&gt; boolean()</h3>


<div class="description">

<p>Check if the number or open requests is below the pipeline threshold</p>
</div></div>
<div class="function">
<h3 id="is_overlimit/1">is_overlimit(Requestqueue::rqueue()) -&gt; boolean()</h3>


<div class="description">

<p>Check if the number of open requests exceed the upper threshold.</p>
</div></div>
<div class="function">
<h3 id="needs/1">needs(Requestqueue::rqueue()) -&gt; non_neg_integer()</h3>


<div class="description">

<p>Return the number of requests needed to fill the queue.
  If the queue already contains the number of requests specified
  by the high threshold of the request queue zero is returned.
  If not, the number of requests needed to hit the high threshold
  is returned regardless of whether the queue is low or not.</p>
</div></div>
<div class="function">
<h3 id="repr/1">repr(Requestqueue::rqueue()) -&gt; term()</h3>


<div class="description">

<p>Represent a queue as an Erlang Term.
  A simple way to format a queue so it can be viewed from the outside</p>
</div></div>
<div class="function">
<h3 id="view/1">view(Requestqueue::rqueue()) -&gt; {low, integer()} | {over_limit, integer()} | {needs, integer()}</h3>


<div class="description">

<p>View a queue as how full/empty it is
  The intention of this function is to capture a number of other
  mutual exclusive functions in one. Rather than request boolean()
  values, we simply carry out a single view on data after which
  we have the desired result.</p>
</div></div>
<div class="function">
<h3 id="member/1">member(Piece::pieceindex(), Offset::chunk_offset() (see module etorrent_types), Length::chunk_len() (see module etorrent_types), Requestqueue::rqueue()) -&gt; boolean()</h3>


<div class="description">

<p>Check if a request queue contains a specific request</p>
</div></div>
<div class="function">
<h3 id="delete/1">delete(Piece::pieceindex(), Offset::chunk_offset() (see module etorrent_types), Length::chunk_len() (see module etorrent_types), Requestqueue::rqueue()) -&gt; rqueue()</h3>


<div class="description">

<p>Delete a specific request from the request queue</p>
</div></div></div>

<authors>

<aname>Magnus Klaar</aname>
<email>magnus.klaar@gmail.com</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
