<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>erlydb_mysql (erl4db) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>erlydb_mysql</h1>
<h2 class="modsummary">This module implements the MySQL driver for ErlyDB.</h2>
<div class="description">
<p>This module implements the MySQL driver for ErlyDB.</p>
 
  <p>This is an internal ErlyDB module that you normally shouldn't have to
  use directly. For most situations, all you have to know
  about this module is the options you can pass to <a href="#start/1" class="seealso">start/1</a>, which
  is called by <a href="erlydb.html#start/2" class="seealso">erlydb:start/2</a>.
 </p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-esql">esql() = {esql, term()}</h3></div>
    <div class="type"><h3 id="type-option">option() = {pool_id, atom()} | {allow_unsafe_statements, boolean()}</h3></div>
    <div class="type"><h3 id="type-options">options() = [option()]</h3></div>
    <div class="type"><h3 id="type-statement">statement() = esql() | binary() | string()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start/1">start(StartOptions::proplist()) -&gt; ok | {error, Error}</h3>


<div class="description">

<p>Start the MySQL dispatcher using the options property list.   
The available options are:</p>
 
   <p><code>pool_id</code> (optional): an atom identifying the connection pool id.      
An 'undefined' value indicates that the default connection      
pool, i.e. 'erlydb_mysql', should be used.</p>
 
   <p><code>hostname</code>: a string indicating the database host name.</p>
 
   <p><code>port</code> (optional): an integer indicating the database port       
('undefined' indicates the default MySQL port, 3306).</p>
 
   <p><code>username</code>: a string indicating the username.</p>
 
   <p><code>password</code>: a string indicating the password.</p>
 
   <p><code>database</code>: a string indicating the database name.</p>
 
   <p><code>allow_unsafe_statements</code>: a boolean value indicating whether the driver
   should
   accept string and/or binary SQL queries and query fragments. If you
   set this value to
   'true', ErlyDB lets you use string or binary Where and Extras expressions
   in generated functions. For more information, see <a href="erlydb.html" class="seealso">erlydb</a>.</p>
 
  <p><code>encoding</code>: the character encoding MySQL will use.</p>
 
  <p><code>poolsize</code>: the number of connections to start.</p>
 
  <p>This function calls mysql:start(), not mysql:start_link(). To
  link the MySQL dispatcher to the calling process, use <a href="#start_link/1" class="seealso">start_link/1</a>.
 </p>
</div></div>
<div class="function">
<h3 id="start_link/1">start_link(StartOptions::proplist()) -&gt; ok | {error, Error}</h3>


<div class="description">

<p>This function is similar to <a href="#start/1" class="seealso">start/1</a>, only it calls
  mysql:start_link() instead of mysql:start().
 </p>
</div></div>
<div class="function">
<h3 id="connect/1">connect(PoolId::atom(), Hostname::string(), Username::string(), Password::string(), Database::string()) -&gt; ok</h3>


<div class="description">

<p>Call connect/7 with Port set to 3306 and Reconnect set to 'true'.
  If the connection is lost, reconnection is attempted.
  The connection process is linked to the calling process.
 </p>
</div></div>
<div class="function">
<h3 id="connect/1-1">connect(PoolId::atom(), Hostname::string, Port::integer(), Username::string(), Password::string(), Database::string(), Reconnect::boolean()) -&gt; ok</h3>


<div class="description">

<p>Add a connection to the connection pool. If PoolId is
    'undefined', the default pool, 'erlydb_mysql', is used. The connection
    process is linked to the calling process.
 </p>
</div></div>
<div class="function">
<h3 id="connect/1-2">connect(PoolId::atom(), Hostname::string, Port::integer(), Username::string(), Password::string(), Database::string(), Encoding, Reconnect::boolean()) -&gt; ok</h3>


<div class="description">

<p>Add a connection to the connection pool, with encoding specified.
  The connection process is linked to the calling process.
 </p>
</div></div>
<div class="function">
<h3 id="connect/1-3">connect(PoolId::atom(), Hostname::string, Port::integer(), Username::string(), Password::string(), Database::string(), Encoding::string(), Reconnect::boolean(), LinkConnection::bool()) -&gt; ok</h3>


<div class="description">

<p>Add a connection to the connection pool, with encoding specified.
  If LinkConnection == false, the connection will not be linked to the
  current process.
 </p>
</div></div>
<div class="function">
<h3 id="get_metadata/1">get_metadata(Options::options()) -&gt; gb_trees()</h3>


<div class="description">

<p>Get the table names and fields for the database.
 </p>
</div></div>
<div class="function">
<h3 id="get_default_pool_id/0">get_default_pool_id() -&gt; atom()</h3>


<div class="description">

<p>Get the default connection pool name for the driver.
 </p>
</div></div>
<div class="function">
<h3 id="q/1">q(Statement::statement()) -&gt; mysql_result()</h3>


<div class="description">

<p>Execute a statement against the MySQL driver with the default options.
  The connection default pool name ('erlydb_mysql') is used.
 </p>
</div></div>
<div class="function">
<h3 id="q/1-1">q(Statement::statement(), Options::options()) -&gt; mysql_result() | exit({unsafe_statement, Statement})</h3>


<div class="description">

<p>Execute a statement directly against the MySQL driver. If
    Options contains the value {allow_unsafe_statements, true}, binary
    and string queries as well as ErlSQL queries with binary and/or
    string expressions are accepted. Otherwise, this function exits.
 </p>
</div></div>
<div class="function">
<h3 id="q2/1">q2(Statement::string() | binary()) -&gt; mysql_result()</h3>


<div class="description">

<p>Execute a (binary or string) statement against the MySQL driver
  using the default options.
  ErlyDB doesn't use this function, but it's sometimes convenient for
  testing.
 </p>
</div></div>
<div class="function">
<h3 id="q2/1-1">q2(Statement::string() | binary(), Options::options()) -&gt; mysql_result()</h3>


<div class="description">

<p>Execute a (binary or string) statement against the MySQL driver.
  ErlyDB doesn't use this function, but it's sometimes convenient for testing.
 </p>
</div></div>
<div class="function">
<h3 id="transaction/1">transaction(Fun::function(), Options::options()) -&gt; {atomic, Result} | {aborted, Reason}</h3>


<div class="description">

<p>Execute a group of statements in a transaction.
    Fun is the function that implements the transaction.
    Fun can contain an arbitrary sequence of calls to
    the erlydb_mysql's query functions. If Fun crashes or returns
    or throws 'error' or {error, Err}, the transaction is automatically
    rolled back.
 </p>
</div></div>
<div class="function">
<h3 id="select/1">select(Statement::statement(), Options::options()) -&gt; {ok, Rows::list()} | {error, Error}</h3>


<div class="description">

<p>Execute a raw SELECT statement.
 </p>
</div></div>
<div class="function">
<h3 id="select_as/1">select_as(Module::atom(), Statement::statement(), Options::options()) -&gt; {ok, Rows} | {error, Error}</h3>


<div class="description">

<p>Execute a SELECT statements for records belonging to the given module,
    returning all rows with additional data to support
    higher-level ErlyDB features.
 </p>
</div></div>
<div class="function">
<h3 id="update/1">update(Statement::statement(), Options::options()) -&gt; {ok, NumAffected} | {error, Err}</h3>


<div class="description">

<p>Execute a DELETE or UPDATE statement.
 </p>
</div></div>
<div class="function">
<h3 id="get_last_insert_id/2">get_last_insert_id(Table::undefined, Options::options()) -&gt; term()</h3>


<div class="description">

<p>Get the id of the last inserted record.
 </p>
</div></div>
<div class="function">
<h3 id="prepare/1">prepare(Name::atom(), Stmt::iolist()) -&gt; ok | {error, Err}</h3>


<div class="description">

<p>Register a prepared statement with the MySQL dispatcher.
    If the dispatcher has a prepared statement with the same name,
    the old statement is overwritten and the statement's version
    is incremented.
 </p>
</div></div>
<div class="function">
<h3 id="execute/1">execute(Name::atom(), Options::options()) -&gt; mysql_result()</h3>


<div class="description">

<p>Execute a statement that was previously prepared with
   prepare/2.
 </p>
</div></div>
<div class="function">
<h3 id="execute/1-1">execute(Name::atom(), Params::[term()], Options::options()) -&gt; mysql_result()</h3>


<div class="description">

<p>Execute a prepared statement with the list of parameters.
 </p>
</div></div>
<div class="function">
<h3 id="execute_select/1">execute_select(Name::atom(), Options::options()) -&gt; {ok, [row]} | {error, Err}</h3>


<div class="description">

<p>Execute a prepared statement and return the result as the select()
    function.
 </p>
</div></div>
<div class="function">
<h3 id="execute_select/1-1">execute_select(Name::atom(), Params::[term()], Options::options()) -&gt; {ok, [Row::tuple()]} | {error, Err}</h3>


<div class="description">

<p>Execute a prepared statement with the list of parameters
    and return the result as the select() function.
 </p>
</div></div>
<div class="function">
<h3 id="execute_update/1">execute_update(Name::atom(), Options::options()) -&gt; {ok, NumUpdated::integer()} | {error, Err}</h3>


<div class="description">

<p>Execute a prepared statement and return the result as the the
    update() function.
 </p>
</div></div>
<div class="function">
<h3 id="execute_update/1-1">execute_update(Name::atom(), Params::[term()], Options::options()) -&gt; {ok, NumUpdated::integer()} | {error, Err}</h3>


<div class="description">

<p>Execute a prepared statement with the list of parameters and
    and return the result as the the update() function.
 </p>
</div></div></div>

<authors>

<aname>Yariv Sadan (yarivvv@gmail.com) (http://yarivsblog.com)</aname>
<email>Yariv Sadan (yarivvv@gmail.com) (http://yarivsblog.com)</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
