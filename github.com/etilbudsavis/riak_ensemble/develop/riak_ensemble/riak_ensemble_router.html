<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>riak_ensemble_router (riak_ensemble) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>riak_ensemble_router</h1>
<h2 class="modsummary">
  The primary purpose of this module is to route requests to ensemble
  leaders given ensemble names, even if the requests are originating
  from nodes that are not part of the ensemble system: eg.</h2>
<div class="description">
<p>
  The primary purpose of this module is to route requests to ensemble
  leaders given ensemble names, even if the requests are originating
  from nodes that are not part of the ensemble system: eg. a remote
  Erlang node using <a href="riak_ensemble_client.html" class="seealso">riak_ensemble_client</a>. This router also  
addresses the issue that ensemble and peer names are arbitrary terms  
and not registered names, and therefore Erlang's built-in messaging  
cannot directly address ensemble peers.</p>
 
  <p>This routing layer is handled by multiple instances of this module
  that run on each node in the ensemble cluster. A request is sent to
  a random router on a given node, which then looks up the ensemble
  leader using its local <code>riak_ensemble_manager</code> state, routing the  
request directly to a local pid (if the leader is local) or forwarding  
on to a router on the respective leading node.</p>
 
  <p>The reason for running multiple router instances per node is to enable  
additional concurrency and not have a single router bottleneck traffic.</p>
 
  <p>A secondary purpose of this module is to provide an isolated version
  of <code>gen_fsm:send_sync_event</code> that converts timeouts into error tuples
  rather than exit conditions, as well as discarding late/delayed messages.
  This isolation is provided by spawning an intermediary proxy process.</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-ensemble_id">ensemble_id() = term()</h3></div>
    <div class="type"><h3 id="type-msg">msg() = term()</h3></div>
    <div class="type"><h3 id="type-target">target() = pid() | <a href="#type-ensemble_id" class="seealso">ensemble_id()</a></h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="start_link/1">start_link(Name::atom()) -&gt; ignore | {error, term()} | {ok, pid()}</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="sync_send_event/1">sync_send_event(Target::target(), Event::msg(), Timeout::timeout()) -&gt; timeout | term()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="sync_send_event/1-1">sync_send_event(Node::node(), Target::target(), Event::msg(), Timeout::timeout()) -&gt; timeout | term()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="sync_proxy/1">sync_proxy(From::pid(), Ref::reference(), Node::node(), Target::target(), Event::msg(), Timeout::timeout()) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="sync_proxy_direct/1">sync_proxy_direct(From::pid(), Ref::reference(), Pid::pid(), Event::msg(), Timeout::timeout()) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="sync_proxy_router/1">sync_proxy_router(From::pid(), Ref::reference(), Node::node(), Target::ensemble_id(), Event::msg(), Timeout::timeout()) -&gt; ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="cast/1">cast(Ensemble::ensemble_id(), Msg::msg()) -&gt; error | ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="cast/1-1">cast(Node::node(), Ensemble::ensemble_id(), Msg::msg()) -&gt; error | ok</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="noconnect_cast/2">noconnect_cast(Dest, Msg) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="routers/0">routers() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="random/1">random(N::pos_integer()) -&gt; pos_integer()</h3>


<div class="description">

<p>Generate "random" number X, such that <code>0 &lt;= X &lt; N</code>.</p>
</div></div>
<div class="function">
<h3 id="init/1">init(X1) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_call/3">handle_call(Request, From, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_cast/2">handle_cast(Msg, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="handle_info/2">handle_info(Info, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="terminate/2">terminate(Reason, State) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="code_change/3">code_change(OldVsn, State, Extra) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="fail_cast/1">fail_cast(X1) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
