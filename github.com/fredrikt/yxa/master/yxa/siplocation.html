<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>siplocation (yxa) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>siplocation</h1>
<h2 class="modsummary">     Interface module for the location database.</h2>
<div class="description">
<p>     Interface module for the location database. Also handles
             processing of REGISTER requests for our domains,
             received by 'incomingproxy' and 'outgoingproxy'.
  </p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="process_register_request/3">process_register_request(Request, YxaCtx, AppName) -&gt; not_homedomain | void()</h3>

<ul class="type">
<li><code>Request = #response{}</code></li><li><code>YxaCtx = #yxa_ctx{}</code></li><li><code>AppName = atom()</code></li></ul>
<div class="description">

<p>    Process a received REGISTER. First check if it is for one
           of our domains (homedomain), then check that it contains
           proper authentication and that the authenticated user is
           allowed to register using this address-of-record.
           Finally, let process_updates() process all the Contact
           headers and update the location database.</p>
</div></div>
<div class="function">
<h3 id="get_user_with_contact/1">get_user_with_contact(URI) -&gt; none | SIPuser</h3>

<ul class="type">
<li><code>URI = #sipurl{}</code></li><li><code>SIPuser = string()</code></li></ul>
<div class="description">

<p>    Checks if any of our users are registered at the location
           specified. Used to determine if we should proxy requests
           to a URI without authorization. NOTE : If you want to
           know all the users (in case there is more than one), you
           should use get_locations_with_contact/1 instead.</p>
</div></div>
<div class="function">
<h3 id="get_locations_with_contact/1">get_locations_with_contact(URI) -&gt; {ok, Locations} | error</h3>

<ul class="type">
<li><code>URI = #sipurl{}</code></li><li><code>Locations = [#siplocationdb_e{}]</code></li></ul>
<div class="description">

<p>    Checks if any of our users are registered at the location
           specified. Return all the location database entrys
           matching the URI, so that the caller can look for a
           specific socket matching the registration(s) if the
           client used Outbound.</p>
</div></div>
<div class="function">
<h3 id="get_locations_for_users/1">get_locations_for_users(In::SipUserList) -&gt; [#siplocationdb_e{}]</h3>

<ul class="type">
<li><code>SipUserList = [string()]</code></li></ul>
<div class="description">

<p>    Looks up all locations for a list of users. Used to find
           out where a set of users are to see where we should route
           a request.</p>
</div></div>
<div class="function">
<h3 id="prioritize_locations/1">prioritize_locations(Locations) -&gt; [#siplocationdb_e{}]</h3>

<ul class="type">
<li><code>Locations = [#siplocationdb_e{}]</code></li></ul>
<div class="description">

<p>    Look through a list of siplocation DB entrys, figure out
           what the lowest priority amongst them are and then return
           all records which has that priority.</p>
</div></div>
<div class="function">
<h3 id="to_url/1">to_url(LDBE) -&gt; #sipurl{}</h3>

<ul class="type">
<li><code>LDBE = #siplocationdb_e{}</code></li></ul>
<div class="description">

<p>    Create a SIP URL from a SIP location db entry.</p>
</div></div>
<div class="function">
<h3 id="sort_most_recent_first/1">sort_most_recent_first(Locations) -&gt; NewLocations</h3>

<ul class="type">
<li><code>Locations = [#siplocationdb_e{}]</code></li><li><code>NewLocations = [#siplocationdb_e{}]</code></li></ul>
<div class="description">

<p>    Sort the locations based on when they were created, most
           recent locations first.</p>
</div></div></div>

<authors>

<aname>Fredrik Thulin</aname>
<email>ft@it.su.se</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
