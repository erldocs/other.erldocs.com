<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>httpsign (httpsign) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>httpsign</h1>
<h2 class="modsummary">Apply the Http signature protocol to web requests.</h2>
<div class="description">
<p>Apply the Http signature protocol to web requests.</p>


 <p>This is a way to add origin authentication, message 
integrity, and replay resistance to HTTP requests.  It is intended to  
be used over the HTTPS protocol.</p>

 <p>It does this by adding an <code>Authorization</code> header to the response. If it exists, 
it gets replaced.</p>

 <p>This header contains a <code>KeyId</code>, the algorithm used to calculate a signature, 
a list of the headers used to calculate the signature, and the signature in 
itself.</p>

 <p>Check <url href="http://tools.ietf.org/html/draft-cavage-http-signatures-00">the http signature draft</url> for more information.</p>

 <em><marker id="An_example_using_the_CLI">An example using the CLI</marker></em>

 <pre class="sh_erlang">   tojans@ubuntu:/mnt/hgfs/develop/erlang/httpsign$ erl -pa ebin
   Erlang R16B02 (erts-5.10.3) [source-5d89ddd] [64-bit] [async-threads:10] [kernel-poll:false]

   Eshell V5.10.3  (abort with ^G)
   1&gt; application:start(httpsign).
   ok
   2&gt; {ok, PemFile} = file:read_file("priv/fixtures/test.pem").
   {ok,&lt;&lt;"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCFENGw33yGihy92pDjZQhl0C3\n6rPJj+CvfSC8+q28"...&gt;&gt;}
   3&gt; KeyId = &lt;&lt;"Test"&gt;&gt;.
   &lt;&lt;"Test"&gt;&gt;
   4&gt; httpsign:register_key(KeyId, sha256, PemFile).
   ok
   5&gt; {ok, Resp} = file:read_file("priv/fixtures/example_response.txt").
   {ok,&lt;&lt;"POST /foo?param=value&pet=dog HTTP/1.1\nHost: example.com\nDate: Thu, 05 Jan 2012 21:31:40 GMT\nContent-Type: a"...&gt;&gt;}
   6&gt; httpsign:is_signed_response(Resp).
   false
   7&gt; SignedResp = httpsign:get_signed_response(Resp,KeyId).
   &lt;&lt;"POST /foo?param=value&pet=dog HTTP/1.1\nHost: example.com\nDate: Thu, 05 Jan 2012 21:31:40 GMT\nContent-Type: applicati"...&gt;&gt;
   8&gt; httpsign:is_signed_response(SignedResp).
   true
   9&gt; AlteredResp = binary:replace(SignedResp, &lt;&lt;"Thu, 05 Jan"&gt;&gt;,&lt;&lt;"Thu, 06 Jan"&gt;&gt;).
   &lt;&lt;"POST /foo?param=value&pet=dog HTTP/1.1\nHost: example.com\nDate: Thu, 06 Jan 2012 21:31:40 GMT\nContent-Type: applicati"...&gt;&gt;
   10&gt; httpsign:is_signed_response(AlteredResp).
   false
   11&gt;</pre>
</div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-algo_type">algo_type() = sha256</h3></div>
    <div class="type"><h3 id="type-filename_type">filename_type() = list()</h3></div>
    <div class="type"><h3 id="type-header_name">header_name() = list()</h3></div>
    <div class="type"><h3 id="type-key_id_type">key_id_type() = binary()</h3></div>
    <div class="type"><h3 id="type-response_type">response_type() = binary()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="register_key/1">register_key(Name::key_id_type(), Algorithm::algo_type(), KeyFileName::filename_type() | binary()) -&gt; ok</h3>


<div class="description">

<p>Register a <code>KeyId</code> by defining it's <code>PEM file</code> and the <code>algorithm</code> used.
  If the last parameter is a <code>binary</code>, this will be considered as the
  content of the PEM-file. If it is a <code>list</code>, this will be assumed to be
  a filename, and the content will be read from a file with this filename.</p>
</div></div>
<div class="function">
<h3 id="get_signed_response/1">get_signed_response(Response::response_type(), KeyId::key_id_type()) -&gt; response_type()</h3>


<div class="description">

<p>Add or replace an <code>Authorization</code> header in a <code>HTTP response</code> using
  only the <code>date</code> header to sign the response.</p>
 
  <p>Use the <code>"date"</code> header from the <code>response</code> as input, and sign it
  using the <code>KeyId</code>.</p>
</div></div>
<div class="function">
<h3 id="get_signed_response/1-1">get_signed_response(Response::response_type(), KeyId::key_id_type(), Fields::[header_name()]) -&gt; response_type()</h3>


<div class="description">

<p>Add or replace an <code>Authorization</code> header in a <code>HTTP response</code> using  
user-defined headers to sign the response.</p>
 
  <p>Use the <code>defined headers</code> from the <code>response</code> to select the headers that
  will be used to build the input for the signature, and sign it using the
  <code>KeyId</code>.</p>
 
  <p>The <code>defined headers</code> are a list of lowercase strings containing header names.</p>
 
   <p><code>get_signed_response(AResponse, AKey, ["date","host","content-type"])</code></p>
 
  <p>The <code>headers</code> must exist in the <code>response</code>!</p>
</div></div>
<div class="function">
<h3 id="is_signed_response/1">is_signed_response(Response::response_type()) -&gt; boolean()</h3>


<div class="description">

<p>Returns <code>true</code> when the <code>HTTP response</code> is contains an <code>authorization</code>
  header  with a known <code>KeyId</code> and a valid signature, <code>false</code> otherwise.</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
