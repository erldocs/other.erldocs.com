<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>erbi_temp_db_helpers (erbi) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>erbi_temp_db_helpers</h1>
<h2 class="modsummary"/>
<div class="description">
</div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-exec_cmd_return">exec_cmd_return() = {ok, {os_pid, integer()}, any()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {ok, {exit_status, integer()}, any()}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| {error, any()}</h3></div>
    <div class="type"><h3 id="type-exec_cmd_scanfn">exec_cmd_scanfn() = fun((string(), any()) -&gt; any())</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="create_dir/1">create_dir(Dir) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="del_dir/1">del_dir(Dir) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="kill_db_pid/2">kill_db_pid(Dir, PidFile) -&gt; term()
</h3>


<div class="description">

<p>lookup pid from pidfile, and kill</p>
 
  <p>kill_db_pid(Dir,PidFile,[KillSequence])
  see kill_os_pid for format of KillSequence</p>
</div></div>
<div class="function">
<h3 id="kill_db_pid/3">kill_db_pid(Dir, PidFile, Sequence) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="kill_os_pid/1">kill_os_pid(Pid) -&gt; term()
</h3>


<div class="description">

<p>kill os pid</p>
 
  <p>kill_os_pid(Pid,[KillSequence])</p>
 
  <p>Killsequence controls how many attempts and what signals to use.
  It consists of a list of terms:
  </p><list>
    <item><p>{Signal,NumberOfAttempts}
      </p><list>Signal: standard signal name, as atom (term,kill,int,quit...)</list><list>NumberOfAttempts: attempts before moving to the next element</list><p>
    </p></item>
    <item><p>{wait,Miliseconds} Set/reset time to wait between attempts.</p></item>
  </list><p>  
After each unsucessful attempt to kill the process, the wait time is increased by  
a factor of 1.5.  Wait time is reset when switching to a new signal.</p>
 
  <p>KillSequence defaults to [{wait,600},{term,9},{kill,3}].
 </p>
</div></div>
<div class="function">
<h3 id="kill_os_pid/2">kill_os_pid(Pid, Sequence) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="check_os_pid/1">check_os_pid(Pid) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_free_db_port/1">get_free_db_port(Erbi) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_free_db_port/2">get_free_db_port(Drv, EnvKey) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="get_free_port/0">get_free_port() -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="save_in_db_data_file/3">save_in_db_data_file(Term, Path, File) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="read_integer/2">read_integer(Path, File) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="find_bin_dir/3">find_bin_dir(Erbi, Candidates, File) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="search_dirs/2">search_dirs(PossiblePaths, Filename) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="wait_for/4">wait_for(Fun, Error, Interval, Tries) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="getenv/2">getenv(Erbi, Key) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="filter_scanner/2">filter_scanner(Mode, Patterns) -&gt; term()
</h3>


<div class="description">

<p>logger generator for exec_cmd</p>
 
 
</div></div>
<div class="function">
<h3 id="filter_scanner/3">filter_scanner(Mode, Patterns, OutFun) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="filter_logger/2">filter_logger(Mode, Patterns) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="filter_logger/3">filter_logger(Mode, Patterns, OutFun) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="exec_start/4">exec_start(DS, Signals, Command, Args) -&gt; term()
</h3>


<div class="description">

<p>execute command as temp db start</p>
 
  <p>The start script of the temp database should be run using this,
  allowing timeouts or other settings to be applied.
 </p>
</div></div>
<div class="function">
<h3 id="exec_start/5">exec_start(DS, Signals, Command, Args, LogScan) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="exec_start/6">exec_start(DS, Signals, Command, Args, Scanner, Logger) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="exec_cmd/1">exec_cmd(Command::chardata() (see module unicode), Args::[chardata() (see module unicode)]) -&gt; exec_cmd_return()</h3>


<div class="description">

<p>execute command, returning OS PID</p>
 
  <p>Arguments:
 </p>
</div></div>
<div class="function">
<h3 id="exec_cmd/1-1">exec_cmd(Command::chardata() (see module unicode), Args::[chardata() (see module unicode)], Logger::wait | nowait | {exec_cmd_scanfn(), any()}) -&gt; exec_cmd_return()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="exec_cmd/1-2">exec_cmd(Command::chardata() (see module unicode), Args::[chardata() (see module unicode)], X3::wait | nowait | {exec_cmd_scanfn(), any()}, Output::none | device() (see module io)) -&gt; exec_cmd_return()</h3>


<div class="description">

<p>execute command, with processing of output</p>
 
  <p>Allows a command to be executed, while capturing the OS pid or exit status, and the output.
  Output can be printed or logged, and can also be scanned or collected.
  Arguments:
  </p><list>
    <item><p>Command: absolute path to executable</p></item>
    <item><p>Args: List of arguments; these do not need to be quoted or escaped; command is exec'ed
        directly.</p></item>
    <item><p>Scanner -- output parser/accumulator, and flow control function.  See below.</p></item>
    <item><p>Logger -- output/logging control.  Can be:
      </p><list><item><p>A device, like the first arg of io:format/3</p></item>
          <item><p>A fun, accepting string(); will be called for all output of Command;
              return is ignored.</p></item>
          <item><p>'none'</p></item>
      </list></item>
  </list><p>
  Return values:
  </p><list>
    <item><p>{ok,{os_pid,Pid},Acc} -- Acc is the accumulated output of Scanner (q.v.)</p></item>
    <item><p>{ok,{exit_status,Status},Acc}</p></item>
    <item><p>{error,Reason}</p></item>
  </list>
 
  <p>Scanner</p>
 
  <p>The scanner argument is a pair of {Scanner,InitAcc}.  Scanner takes two arguments:
  </p><list>
    <item><p>Data: string() -- a chunk of output from the command.</p></item>
    <item><p>Acc: any() -- accumulator; starts with InitAcc</p></item>
  </list><p>
  Scanner returns one of:
  </p><list>
    <item><p>{ok,Acc} -- exec_cmd will return immediately, with {ok,{os_pid,Pid},Acc}</p></item>
    <item><p>{error,Reason} -- exec_cmd returns immediately with this value</p></item>
    <item><p>{acc,Acc} -- continue processing output, with new accumulator value</p></item>
  </list><p>
  Scanner can also accept 'wait' and 'nowait' which make the function wait (or not) for
  Command to finish; output Acc will be 'undefined'.ls</p>
</div></div></div>

<authors>
<aname> </aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
