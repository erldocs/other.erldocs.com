<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>sipauth (yxa-cnam) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>sipauth</h1>
<h2 class="modsummary">     SIP authentication functions.</h2>
<div class="description">
<p>     SIP authentication functions.</p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="realm/0">realm() -&gt; string()</h3>


<div class="description">

<p>    Return this proxys configured authentication realm, or the
           hostname if no realm has been configured.</p>
</div></div>
<div class="function">
<h3 id="get_nonce/1">get_nonce(Timestamp) -&gt; string()</h3>

<ul class="type">
<li><code>Timestamp = string()</code></li></ul>
<div class="description">

<p>    Create a nonce. Since we have not located any useful
           randomness functions in Erlang, and since all proxys that
           share authentication realm should be able to use the
           responses to the challenges we create here, we use the
           current time plus the configured sipauth_password.</p>
</div></div>
<div class="function">
<h3 id="get_challenge/0">get_challenge() -&gt; Challenge</h3>

<ul class="type">
<li><code>Challenge = {Realm, Nonce, Timestamp}</code></li><li><code>Realm = string()</code></li><li><code>Nonce = string()</code></li><li><code>Timestamp = string()</code></li></ul>
<div class="description">

<p>    Create a challenge tuple.</p>
</div></div>
<div class="function">
<h3 id="get_response/5">get_response(Nonce, Method, URIstr, User, Password) -&gt; term()</h3>


<div class="description">
<p>Equivalent to <a href="#get_response/6" class="seealso">get_response(Nonce, Method, URIstr, User, Password,
	     realm())</a>.</p>
</div></div>
<div class="function">
<h3 id="get_response/6">get_response(Nonce, Method, URIstr, User, Password, Realm) -&gt; Response | none</h3>

<ul class="type">
<li><code>Nonce = string()</code></li><li><code>Method = string()</code></li><li><code>URIstr = string()</code></li><li><code>User = string()</code></li><li><code>Password = string() | nomatch</code></li><li><code>Realm = string()</code></li><li><code>Response = string()</code></li></ul>
<div class="description">

<p>    Get the correct response to a challenge, given a nonce,
           method, URI, username and password.</p>
</div></div>
<div class="function">
<h3 id="classify_number/2">classify_number(Number, Regexps) -&gt; {ok, Class} | {ok, unknown} | {error, E}</h3>

<ul class="type">
<li><code>Number = string() | none</code></li><li><code>Regexps = [{Regexp, Class}]</code></li><li><code>Regexp = string()</code></li><li><code>Class = atom()</code></li><li><code>Class = atom()</code></li></ul>
<div class="description">

<p>    Search a list of regexps until Number matches the Regexp
           and return the Class.</p>
</div></div>
<div class="function">
<h3 id="get_user_verified/2">get_user_verified(Header, Method) -&gt; false | {stale, User} | {authenticated, User}</h3>

<ul class="type">
<li><code>Header = #keylist{}</code></li><li><code>Method = string()</code></li><li><code>User = string()</code></li></ul>
<div class="description">

<p>    Check if there is an Authorization: header in Header and
           check if it contains a valid response of a challenge we
           supposedly sent out.</p>
</div></div>
<div class="function">
<h3 id="get_user_verified_proxy/2">get_user_verified_proxy(Header, Method) -&gt; false | {stale, User} | {authenticated, User}</h3>

<ul class="type">
<li><code>Header = #keylist{}</code></li><li><code>Method = string()</code></li><li><code>User = string()</code></li></ul>
<div class="description">

<p>    Check if there is an Proxy-Authorization: header in Header
           and check if it contains a valid response of a challenge
           we supposedly sent out. Might throw an {siperror, ...} if
           something is wrong with the authorization header. Notes :
           XXX we should verify the URI too</p>
</div></div>
<div class="function">
<h3 id="pstn_get_user_verified/2">pstn_get_user_verified(Header, Method) -&gt; false | {stale, User} | {authenticated, User} | {peer_authenticated, User}</h3>

<ul class="type">
<li><code>Header = #keylist{}</code></li><li><code>Method = string()</code></li><li><code>User = string()</code></li></ul>
<div class="description">

<p>    Authenticate through X-YXA-Peer-Auth or, if that does not
           exist, through Proxy-Authentication.</p>
</div></div>
<div class="function">
<h3 id="is_allowed_pstn_dst/4">is_allowed_pstn_dst(User, ToNumber, Header, Class) -&gt; true | false</h3>

<ul class="type">
<li><code>User = string()</code></li><li><code>ToNumber = string()</code></li><li><code>Header = #keylist{}</code></li><li><code>Class = atom()</code></li></ul>
<div class="description">

<p>    Check if a given User is explicitly allowed to call a
           number in a given Class.</p>
</div></div>
<div class="function">
<h3 id="can_use_address/2">can_use_address(User, URL) -&gt; true | false</h3>

<ul class="type">
<li><code>User = string()</code></li><li><code>URL = #sipurl{}</code></li></ul>
<div class="description">

<p>    Check if a given User may use address Address as From: by
           using the function can_use_address_detail/2 not caring
           about the reason it returns.</p>
</div></div>
<div class="function">
<h3 id="can_use_address_detail/2">can_use_address_detail(User, URL) -&gt; {Verdict, Reason}</h3>

<ul class="type">
<li><code>User = string()</code></li><li><code>URL = #sipurl{}</code></li><li><code>Verdict = true | false</code></li><li><code>Reason = ok | eperm | nomatch | error</code></li></ul>
<div class="description">

<p>    Check if a given User may use address Address as From:</p>
</div></div>
<div class="function">
<h3 id="can_register/2">can_register(Header, ToURL) -&gt; {{Verdict, Reason}, User} | {stale, User} | {false, none}</h3>

<ul class="type">
<li><code>Header = #keylist{}</code></li><li><code>ToURL = #sipurl{}</code></li><li><code>Verdict = true | false</code></li><li><code>Reason = ok | eperm | nomatch | error</code></li></ul>
<div class="description">

<p>    Check if a REGISTER message authenticates OK, and check
           that the User returned from credentials check actually
           may use this To: (NOT From:, so third party registrations
           are not denied per se by this check).</p>
</div></div>
<div class="function">
<h3 id="add_x_yxa_peer_auth/5">add_x_yxa_peer_auth(Method, URI, Header, User, Secret) -&gt; NewHeader</h3>

<ul class="type">
<li><code>Method = string()</code></li><li><code>URI = #sipurl{}</code></li><li><code>Header = #keylist{}</code></li><li><code>User = string()</code></li><li><code>Secret = string()</code></li><li><code>NewHeader = #keylist{}</code></li></ul>
<div class="description">

<p>    Compute and add an X-YXA-Peer-Auth header to Header.</p>
</div></div>
<div class="function">
<h3 id="add_credentials/7">add_credentials(X1::Type, HeaderName, Method, URI, Header, User, Secret) -&gt; NewHeader</h3>

<ul class="type">
<li><code>Type = atom()</code></li><li><code>HeaderName = string()</code></li><li><code>Method = string()</code></li><li><code>URI = #sipurl{}</code></li><li><code>Header = #keylist{}</code></li><li><code>User = string()</code></li><li><code>Secret = string()</code></li><li><code>NewHeader = #keylist{}</code></li></ul>
<div class="description">

<p>    Compute and add a MD5 digest response header (HeaderName)
           to a header.</p>
</div></div></div>

<authors>

<aname>Magnus Ahltorp</aname>
<email>ahltorp@nada.kth.se</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
