<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>jobs (jobs) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>jobs</h1>
<h2 class="modsummary">
  This is the public API of the JOBS framework.</h2>
<div class="description">
<p>
  This is the public API of the JOBS framework.
 </p></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="ask/1">ask(Type) -&gt; {ok, Opaque} | {error, Reason}</h3>


<div class="description">

<p>Asks permission to run a job of Type. Returns when permission granted.</p>
 
  <p>The simplest way to have jobs regulated is to spawn a request per job.
  The process should immediately call this function, and when granted
  permission, execute the job, and then terminate.
  If for some reason the process needs to remain, to execute more jobs,
  it should explicitly call <code>jobs:done(Opaque)</code>.
  This is not strictly needed when regulation is rate-based, but as the
  regulation strategy may change over time, it is the prudent thing to do.</p>
</div></div>
<div class="function">
<h3 id="done/1">done(Opaque) -&gt; ok</h3>


<div class="description">

<p>Signals completion of an executed task.</p>
 
  <p>This is used when the current process wants to submit more jobs to load
  regulation. It is mandatory when performing counter-based regulation
  (unless the process terminates after completing the task). It has no
  effect if the job type is purely rate-regulated.</p>
</div></div>
<div class="function">
<h3 id="run/2">run(Queue::Type, Function::function()) -&gt; Result</h3>


<div class="description">

<p>Executes Function() when permission has been granted by job regulator.</p>
 
  <p>This is equivalent to performing the following sequence:
  </p><pre class="sh_erlang">
  case jobs:ask(Type) of
     {ok, Opaque} -&gt;
        try Function()
          after
            jobs:done(Opaque)
        end;
     {error, Reason} -&gt;
        erlang:error(Reason)
  end.
  </pre>
</div></div>
<div class="function">
<h3 id="enqueue/2">enqueue(Queue, Item) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="dequeue/2">dequeue(Queue, N) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="job_info/1">job_info(X1::Opaque) -&gt; undefined | Info</h3>


<div class="description">

<p>Retrieves job-specific information from the <code>Opaque</code> data object.</p>
 
  <p>The queue could choose to return specific information that is passed to a
  granted job request. This could be used e.g. for load-balancing strategies.</p>
</div></div>
<div class="function">
<h3 id="add_queue/1">add_queue(Name::any(), Options::[{Key, Value}]) -&gt; ok</h3>


<div class="description">

<p>Installs a new queue in the load regulator on the current node.</p>
</div></div>
<div class="function">
<h3 id="modify_queue/1">modify_queue(Name::any(), Options::[{Key, Value}]) -&gt; ok | {error, Reason}</h3>


<div class="description">

<p>Modifies queue parameters of existing queue.</p>
 
  <p>The queue parameters that can be modified are <code>max_size</code> and <code>max_time</code>.</p>
</div></div>
<div class="function">
<h3 id="delete_queue/1">delete_queue(Name) -&gt; boolean()</h3>


<div class="description">

<p>Deletes the named queue from the load regulator on the current node.
  Returns <code>true</code> if there was in fact such a queue; <code>false</code> otherwise.</p>
</div></div>
<div class="function">
<h3 id="ask_queue/2">ask_queue(QueueName, Request) -&gt; Reply</h3>


<div class="description">

<p>Sends a synchronous request to a specific queue.</p>
 
  <p>This function is mainly intended to be used for back-end processes that act
  as custom extensions to the load regulator itself. It should not be used by
  regular clients. Sophisticated queue behaviours could export gen_server-like
  logic allowing them to respond to synchronous calls, either for special
  inspection, or for influencing the queue state.</p>
</div></div>
<div class="function">
<h3 id="add_counter/2">add_counter(Name, Options) -&gt; ok</h3>


<div class="description">

<p>Adds a named counter to the load regulator on the current node.
  Fails if there already is a counter the name <code>Name</code>.</p>
</div></div>
<div class="function">
<h3 id="delete_counter/1">delete_counter(Name) -&gt; boolean()</h3>


<div class="description">

<p>Deletes a named counter from the load regulator on the current node.
  Returns <code>true</code> if there was in fact such a counter; <code>false</code> otherwise.</p>
</div></div>
<div class="function">
<h3 id="add_group_rate/2">add_group_rate(Name, Options) -&gt; ok</h3>


<div class="description">

<p>Adds a group rate regulator to the load regulator on the current node.
  Fails if there is already a group rate regulator of the same name.</p>
</div></div>
<div class="function">
<h3 id="delete_group_rate/1">delete_group_rate(Name) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="info/1">info(Item) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="queue_info/1">queue_info(Name) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="queue_info/2">queue_info(Name, Item) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="modify_regulator/4">modify_regulator(Type, QName, RegName, Opts) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="modify_counter/2">modify_counter(CName, Opts) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="modify_group_rate/2">modify_group_rate(GRName, Opts) -&gt; term()
</h3>


<div class="description">
 </div></div></div>

<authors>

<aname>: Ulf Wiger</aname>
<email>ulf@wiger.net</email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
