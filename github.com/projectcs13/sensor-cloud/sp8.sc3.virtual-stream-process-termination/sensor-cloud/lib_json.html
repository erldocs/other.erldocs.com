<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>lib_json (sensor-cloud) -  (Erlang Documentation)</title>
    <link href="/erldocs.css" type="text/css" rel="stylesheet"/>
    <link href="/search.xml" rel="search" type="application/opensearchdescription+xml" title="erldocs"/>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-54292016-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <div id="sidebar" class="inactive">
      <input type="text" id="search" autocomplete="off" placeholder="press TAB to search"/>
      <ul id="results"> </ul>
    </div>

    <div id="content">
      <div style="margin:0px; padding:10px 20px;">
        

<h1>lib_json</h1>
<h2 class="modsummary">Library for creating, reading, updating, and deleting fields in JSON objects.</h2>
<div class="description">
<p><em><marker id="Library_for_creating,_reading,_updating,_and_deleting_fields_in_JSON_objects">Library for creating, reading, updating, and deleting fields in JSON objects</marker></em>
</p></div>
<div id="types" class="category"><h4><a href="#types">Types</a></h4><hr />
    <div class="type"><h3 id="type-attr">attr() = atom() | string()</h3></div>
    <div class="type"><h3 id="type-field">field() = atom() | string() | [atom()]</h3></div>
    <div class="type"><h3 id="type-json">json() = <a href="#type-json_string" class="seealso">json_string()</a> | <a href="#type-mochijson" class="seealso">mochijson()</a></h3></div>
    <div class="type"><h3 id="type-json_input_value">json_input_value() = atom()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| binary()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| integer()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a href="#type-json" class="seealso">json()</a><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<a href="#type-json_input_value" class="seealso">json_input_value()</a>]</h3></div>
    <div class="type"><h3 id="type-json_output_value">json_output_value() = boolean()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| binary()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| integer()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a href="#type-json_string" class="seealso">json_string()</a><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<a href="#type-json_output_value" class="seealso">json_output_value()</a>]</h3></div>
    <div class="type"><h3 id="type-json_string">json_string() = string()</h3></div>
    <div class="type"><h3 id="type-mochijson">mochijson() = tuple()</h3></div></div>
<div id="functions" class="category"><h4><a href="#functions">Functions</a></h4><hr />
<div class="function">
<h3 id="add_value/1">add_value(Json::json(), Field::field(), Value::json_input_value()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Adds a new value to a field with the name 'Field' and the value 'Value' to a JSON object.  
If the field doesn't exist then it is added, but only if the Field path is valid. This  
means that it can not add nested fields, but it can add a field either to the root or  
inside another attribute.</p>
 
  <p>Note: Either "{}", [] or "" is okay to use for an empty json object, both for 'Json' and 'Value'.
  Note: To make an attribute with no value, supply it with an empty list binary
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Field = "attr2".
  &gt; Value = &lt;&lt;"value2"&gt;&gt;.
  &gt; lib_json:add_value(Json, Field, Value).
  "{\"attr1\":\"value1\", \"attr2\":\"value2\"}"</pre><p>
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Field = "attr2.attr3".
  &gt; Value = "value2".
  &gt; lib_json:add_value(Json, Field, Value).
  "{\"attr1\":\"value1\"}"</pre>
</div></div>
<div class="function">
<h3 id="add_values/1">add_values(Json::json(), FieldsAndValues::[{Field::field(), Value::json_input_value()}]) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Adds a list of attributes and values to a JSON object.  
If a field in the list exist then it is added, but only if the Field path is valid. This  
means that it can not add nested fields, but it can add a field either to the root or  
inside another attribute. Already existing (non-empty) fields are not overwritten</p>
 
  <p>Note: Either "{}", [] or "" is okay to use for an empty json object, both for 'Json' and 'Value'.
  Note: To make an attribute with no value, supply it with an empty list binary
  Example
  </p><pre class="sh_erlang">  &gt; Json = "{}".
  &gt; FieldValue1 = {attr1, &lt;&lt;"value1"&gt;&gt;}.
  &gt; FieldValue2 = {attr2, &lt;&lt;"value2"&gt;&gt;}.
  &gt; FieldValue3 = {"attr2.attr3", &lt;&lt;"value3"&gt;&gt;}.
  &gt; FieldValues = [FieldValue1, FieldValue2, FieldValue3].
  &gt; lib_json:add_values(Json, FieldValues).
  "{\"attr1\":\"value1\", \"attr2\":\"value2\"}"</pre>
 
  <p>Example
  </p><pre class="sh_erlang">  &gt; Json = "{}".
  &gt; FieldValue1 = {attr1, &lt;&lt;"value1"&gt;&gt;}.
  &gt; FieldValue2 = {attr2, "{}"}.
  &gt; FieldValue3 = {"attr2.attr3", &lt;&lt;"value3"&gt;&gt;}.
  &gt; FieldValue4 = {"attr2.attr4", &lt;&lt;"value4"&gt;&gt;}.
  &gt; FieldValues = [FieldValue1, FieldValue2, FieldValue3, FieldValue4].
  &gt; lib_json:add_values(Json, FieldValues).
  "{\"attr1\":\"value1\",\"attr2\":{\"attr3\":\"value3\",\"attr4\":\"value4\"}}"</pre>
 
  <p>Example
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr2\":[]}".
  &gt; FieldValue1 = {attr1, &lt;&lt;"value1"&gt;&gt;}.
  &gt; FieldValue3 = {"attr2", 1}.
  &gt; FieldValue4 = {"attr2", 2}.
  &gt; FieldValues = [FieldValue1, FieldValue3, FieldValue4].
  &gt; lib_json:add_values(Json, FieldValues).
  "{\"attr1\":\"value1\",\"attr2\": [1, 2]}"</pre>
</div></div>
<div class="function">
<h3 id="convert_undefined/1">convert_undefined(Value) -&gt; term()
</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="decode/1">decode(Json::json_string()) -&gt; mochijson()</h3>


<div class="description">

<p>  
Decodes a json object into mochijson format.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; lib_json:decode(Json).
  {struct,[{&lt;&lt;"attr1"&gt;&gt;,&lt;&lt;"value1"&gt;&gt;}]}</pre>
</div></div>
<div class="function">
<h3 id="encode/1">encode(Json::json()) -&gt; iolist()</h3>


<div class="description">

<p>  
Encodes a json object into an iolist() that can easily be converted into a string.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = {struct,[{&lt;&lt;"attr1"&gt;&gt;,&lt;&lt;"value1"&gt;&gt;}]}".
  &gt; lib_json:encode(Json).
  [123,[34,&lt;&lt;"attr1"&gt;&gt;,34],58,[34,&lt;&lt;"value1"&gt;&gt;,34],125]</pre>
</div></div>
<div class="function">
<h3 id="field_value_exists/1">field_value_exists(Json::json(), Query::string(), Value::json_input_value()) -&gt; boolean()</h3>


<div class="description">

<p>  
Check if a specific field with a specific value exists in a JSON object.  
Handles wildcard searches for fields (not wildcard for values.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Query = "attr1".
  &gt; lib_json:field_value_exists(Json, Query, Value).
  true</pre>
</div></div>
<div class="function">
<h3 id="get_field/1">get_field(Json::json(), Query::string()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Get the value at a certain field in a JSON object.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Query = "attr1".
  &gt; lib_json:get_field(Json, Query).
  "value1"</pre><p>
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Query = "attr2".
  &gt; lib_json:get_field(Json, Query).
  undefined</pre>
</div></div>
<div class="function">
<h3 id="get_fields/1">get_fields(Json::json(), Fields::[field()]) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Get the values for a list of specified fields.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\",\"attr2\":\"value2\"}".
  &gt; Fields = ["attr1", "attr2"].
  &gt; lib_json:get_fields(Json, Fields).
  ["value1", "value2"]</pre><p>
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\",\"attr2\":\"value2\"}".
  &gt; Fields = ["attr1", "attr3"].
  &gt; lib_json:get_fields(Json, Fields).
  ["value1", undefined]</pre>
</div></div>
<div class="function">
<h3 id="get_field_value/1">get_field_value(Json::json(), Query::field(), Value::json_input_value()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Get a certain value of a certain field. Returns 'undefined' if there is no field with that value.</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\": [{\"attr2\":\"value1\"},{\"attr2\":\"value2\"}]}".
  &gt; Query = "attr1[*].attr2".
  &gt; Value = "value2".
  &gt; lib_json:get_field_value(Json, Query, Value).
  "value2"</pre>
</div></div>
<div class="function">
<h3 id="replace_field/1">replace_field(Json::json(), Query::field(), Value::json_input_value()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Replaces the value of a field 'Query' with 'Value' in a JSON object</p>
 
  <p>Note: To make an attribute with no value, supply it with an empty list binary
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Query = "attr1".
  &gt; Value = &lt;&lt;"poff"&gt;&gt;.
  &gt; lib_json:replace_field(Json, Query, Value).
  "{\"attr1\":\"poff\"}"</pre>
</div></div>
<div class="function">
<h3 id="replace_fields/1">replace_fields(Json::json(), FieldsAndValues::[{Field::field(), Value::json_input_value()}]) -&gt; json_output_value()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="rm_field/1">rm_field(Json::json(), Query::field()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Removes the field 'Query' from a JSON object</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Query = "attr1".
  &gt; lib_json:rm_field(Json, Query).
  "{}"</pre>
</div></div>
<div class="function">
<h3 id="rm_fields/1">rm_fields(Json::json(), Field::[Field::field()]) -&gt; json_output_value()</h3>


<div class="description">
 </div></div>
<div class="function">
<h3 id="set_attr/1">set_attr(Attr::attr(), Value::json_input_value()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Sets a json attribute 'Attr' to 'Value'. This function is only for creating  
a proper JSON object with one attribute 'Attr' in it set to 'Value'.</p>
 
  <p>For adding add an attribute and/or value see: <a href="#add_value/3" class="seealso">add_value/3</a></p>
 
  <p>For replaceing a value see: <a href="#replace_field/3" class="seealso">replace_value/3</a></p>
 
  <p>Note: To make an attribute with no value, supply it with an empty list binary
  Example:
  </p><pre class="sh_erlang">  &gt; Json = "{\"attr1\":\"value1\"}".
  &gt; Attr = "attr1".
  &gt; Value = value
  &gt; lib_json:set_attr(Attr, Value).
  "{\"attr1\":\"value\"}"</pre>
</div></div>
<div class="function">
<h3 id="set_attrs/1">set_attrs(AttrsAndValuesList::[{Attr::attr(), Value::json_input_value()}]) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Sets a lsit of json attributes. This function is only for creating  
a proper JSON object with a list of attributes of {'Attr', Value}.</p>
 
  <p>Note: To make an attribute with no value, supply it with an empty list binary
  This function uses <a href="#add_values/2" class="seealso">add_values/2</a> and gives it an
  empty json object. See <a href="#add_values/2" class="seealso">add_values/2</a> for examples
  on how to use this function.
 </p>
</div></div>
<div class="function">
<h3 id="to_string/1">to_string(Json::mochijson() | any()) -&gt; json_string() | string()</h3>


<div class="description">

<p>  
Converts a mochijson structure or a mochijson encoded structure into a string</p>
 
  <p>Example:
  </p><pre class="sh_erlang">  &gt; Json = {struct,[{&lt;&lt;"attr1"&gt;&gt;,&lt;&lt;"value1"&gt;&gt;}]}.
  &gt; lib_json:to_string(Json).
  "{\"attr1\":\"value\"}"</pre>
</div></div>
<div class="function">
<h3 id="get_and_add_id/1">get_and_add_id(JsonStruct::mochijson()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Gets the '_id' from the root, gets the '_source'. Adds _id as  
id' in _source and return the new JSON object.</p>
 
  <p>TODO Move to api_help</p>
</div></div>
<div class="function">
<h3 id="get_list_and_add_id/1">get_list_and_add_id(JsonStruct::mochijson()) -&gt; json_string()</h3>


<div class="description">

<p>  
Get the search results and performs get_and_add_id/1 on each  
elements in the result list.  
NOTE: Deprecated, use get_list_and_add_id/2 instead</p>
 
  <p>TODO Move to api_help</p>
</div></div>
<div class="function">
<h3 id="get_list_and_add_id/1-1">get_list_and_add_id(JsonStruct::mochijson(), JsonKey::atom()) -&gt; json_string()</h3>


<div class="description">

<p>  
Get the search results and performs get_and_add_id/1 on each  
elements in the result list. The resulting list will be returned  
as a proper JSON object with the JsonKey as the attribute.</p>
 
  <p>Return: get_list_and_add_id(List, Attribute) -&gt; "{\"Attribute\": List}"</p>
 
  <p>TODO Move to api_help</p>
</div></div>
<div class="function">
<h3 id="get_and_add_password/1">get_and_add_password(JsonStruct::mochijson()) -&gt; json_output_value()</h3>


<div class="description">

<p>  
Gets the 'password' from the root, gets the '_source'. Adds password as  
password' in _source and return the new JSON object.</p>
 
  <p>TODO Move to api_help</p>
</div></div>
<div class="function">
<h3 id="get_list_and_add_password/1">get_list_and_add_password(JsonStruct::mochijson()) -&gt; json_string()</h3>


<div class="description">

<p>  
Get the search results and performs get_and_add_password/1 on each  
elements in the result list.</p>
 
  <p>TODO Move to api_help</p>
</div></div></div>

<authors>

<aname>Tommy Mattsson, Georgios Koutsoumpakis</aname>
<email> </email></authors>
      </div>
  </div>

    <script type="text/javascript">
      var CURRENT_ROOT = "../";
    </script>

    <script type="text/javascript" src="/jquery.js"></script>
    <script type="text/javascript" src="../erldocs_index.js"></script>
    <script type="text/javascript" src="/erldocs.js"></script>
  </body>
</html>
